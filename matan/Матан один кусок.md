# Неопределённый интеграл
## Определение интеграла и первообразной

> [!abstract] Первообразная
> Пусть $I$ - промежуток, $f$ определена на $I$. $F$ - ==первообразная== для $f$ на промежутке $I$, если $F'(x) = f(x),\ x\in I$

> [!abstract] Неопределенный интеграл
> $\int f(x)\,dx$
> 1) Любая фиксированная первообразная
> 2) Множество всех первообразных

## Методы интегрирования
### Теорема: интегрирование по частям
$$\int u\,dv = uv - \int v\,du$$

1) На некоторых промежутках $\exists u'$ и $v'$
2) $\exists \int v\,du$
Тогда $\exists \int u\,dv$ и работает формула интегрирования по частям
**Доказательство**
$$(uv)' - (\int v\,du)' + c' = u\cdot v' $$
**Замечание**
$$\int (\alpha f + \beta g) = \alpha \int f + \beta \int g$$

### Теорема: метод замены переменной
$$\int \dfrac {x\, dx}{1+ x^2} = \left \{ t = x^2 \\ \,dt = 2x\,dx \right \} = \dfrac 1 2 \int \dfrac{\,dt}{1+ t} =$$ $$\dfrac 1 \ln|1 + t| + C = \dfrac 1 2 \ln|1 + x^2| + C$$
**Теорема**
Пусть $\int f(x)\,dx = F(x) + C$, $x = \varphi(t), t\in I$ Пусть $\varphi$ дифф. на $I$. Тогда справедлива замена $\varphi(t) = x,\ \varphi'\,dt = \,dx$, то есть $\int f(\varphi(t))\varphi'(t)\,dt = F(\varphi(t)) + C$

**Доказательство**
$$(F(\varphi(t)) + C)' = F'_x \cdot \varphi'(t) = f(\varphi(t)\cdot \varphi'(t))$$
## Интегрирование рациональных дробей

> [!abstract] Простейшие дроби
> ==Простейшей дробью== называется дробь $\dfrac {P(x)}{Q(x)}$, где $\deg P \leq \deg Q$

### Виды простейших дробей
1) $\dfrac {A}{(x - a)^n}$, $A \in \mathbb R,\ n \in \mathbb N$
2) $\dfrac {Mx + N}{x^2 + px + q}$, $M, N, p, q \in \mathbb R$, дискриминант знаменателя отрицательный.
### Лемма 1
**Лемма**
Если $Q(x) = (x - a)^n \cdot \tilde Q(x)$, $\tilde Q(a) \neq 0$, то можно представить $\dfrac{P(x)}{Q(x)}$ в виде $\dfrac {P(x)}{Q(x)} = \dfrac {A}{(x - a)^n} + \dfrac {\tilde P(x)}{(x -a)^{n - 1} \cdot \tilde Q(x)}$

**Следствия**
$$\dfrac {P(x)}{Q(x)} = \dfrac {A_n}{(x - a)^n} + \dfrac {H(x)}{\tilde Q(x)}$$

**Доказательство**
$$\dfrac {P(x)}{Q(x)} - \dfrac {A}{(x - a)^n} = \dfrac{P(x) - A\cdot \tilde Q(x)}{Q(x)}$$
$$Q(x) = (x - a)^n \cdot \tilde Q(x)$$
$$A: P(a) - A\cdot \tilde Q(a) = 0 \implies A = \dfrac {P(a)}{\tilde Q(a)}$$
### Лемма 2
**Лемма**
Пусть $Q(x) = (x^2 + px + q)^m \tilde Q(x)$, где дискриминант отрицательный. Тогда $\dfrac {P(x)}{Q(x)} = \dfrac {Mx + N}{(x^2 + px + q)^m} + \dfrac {\tilde P(x)}{(x^2 + px + q)^{m-1} \tilde Q(x)}$

**Следствие**
$\dfrac {P(x)}{Q(x)} = \dfrac {M_mx + N_m}{(\dots)^m} + \dfrac {M_{m - 1}x + N_{m - 1}}{(\dots)^{m - 1}} + \dots  + \dfrac {1(x)}{\tilde Q(x)}$

**Доказательство**
$$\dfrac {P(x)}{Q(x)} = \dfrac {Mx + N}{(x^2 + px + q)^m} = \dfrac {P(x) - (Mx+N)\tilde Q(x)}{(\dots)^m\tilde Q(x)} = $$
$$= \dfrac{P(x) - (Mx +n)\tilde Q(x)}{(x - x_1)^m(x - \bar x_1)^m \tilde Q(x)}$$
$$\begin {cases} P(x_1) - (Mx_1 + N)\tilde Q(x_1) = 0 \\ P(\bar x_1) - (M_1\bar x_1 + N)\tilde Q(\bar x_1) = 0 \end{cases}$$ У СЛУ с двумя уравениями есть два неизвестных $\implies\ \exists M, N$

### Теорема: любая дробь разложима на простейшие
**Теорема**

**Доказательство**
$$\dfrac {P(x)}{Q(x)} = \dfrac {P(x)}{(x - a_1)^{n_1} \dots (x - a_k)^{n_k}(x^2 + p_1x + q_1)^{m_1}\dots (x^2 + p_tx + q_t^{m_t})}$$
Последовательно применим лемму 1 и 2.
$$\sum\limits_{i = 1}^{n_1} \dfrac {c_i}{(x - a_1)^{i}} + \dots + \sum\limits+{i = 1}^{n_k} \dfrac {d_i}{(x - a_k)^{i}} + \dots = 1$$

### Пример к теореме
$$\dfrac P Q = \dfrac{(x^2 + 1)}{(x + 1)^2 (x - 1)} = \dfrac {A}{(x + 1)^2} + \dfrac {B}{x + 1} + \dfrac C {x - 1} = $$
$$= \dfrac {A(x - 1) + B(x^2  - 1) + C (x + 1)^2}{(x + 1)^2(x - 1)}$$
$$x^2 + 1 = A(x - 1) B(x^2 - 1) + C(x + 1)^2$$
Затем методом неопределённых коэффициентов найдем $A, B, C$

**Можно использовать формулу Тейлора**
$$\dfrac x {(x + 1)(x + 2)(x + 3)} = \dfrac A {x + 1} + \dfrac B {x + 2} + \dfrac C {c + 3}$$
1) $A = ?$, корень $-1$, $f(x) = \dfrac {x}{(x + 2)(x + 3)}$, $A = f(-1) = - \dfrac 1 2$    
$$\dfrac {P(x)}{Q(x)} = \dfrac {f(x)}{x + 1} = \left \{ f(x) = f(-1) + f'(-1)(x + 1)\dots \text{- формула Тейлора} \right \} =$$
$$= \dfrac {(f(-1) + f'(-1)(x+1) + \dots)}{x + 1}$$
$$f(-1) = A$$
$$\dfrac x {(x + 1)^2(x + 2)(x + 3)} = \dfrac {A}{(x + 1)^2} + \dfrac {B}{(x + 1)} + \dfrac C {x + 2} + \dfrac D {x + 3}$$

### Метод Остроградского
$$\int\dfrac{P(x)}{Q(x)}\,dx$$
$$\deg P_k = \deg Q$$
Если у $Q(x)$ есть кратный корень, то применяют метод Остроградского. $Q(x) = Q_1(x) \cdot Q_2(x)$, где $Q_2(x)$ - неприв. множителль $Q$ в степени $1$.
Например:
$$Q(x) = (x^2 + 1)^5(x - 2)^2$$
$$Q_2 = (x^2 + 1)(x - 2)$$

Тогда $\int\dfrac{P(x)}{Q(x)}\,dx = \dfrac {P_1(x)}{Q_1(x)} + \int \dfrac {P_2(x)\,dx}{Q_2(x)}$
Задача свелась к интегралу, где в знаменателе нет кратных корней. Продифференцируем обе части.

$$\dfrac {P(x)}{Q(x)} = \dfrac {P_1'(x)Q_1(x) - P_1(x)Q_1'(x)}{Q_1^2(x)} + \dfrac {P_2(x)}{Q_2(x)}$$
$$P(x) = \dfrac{P_1'(x)Q(x)}{Q_1(x)} - \dfrac {P_1(x)Q_1'(x)Q(x)}{Q_1^2(x)} + \dfrac {P_2(x)Q(x)}{Q_2(x)}$$

## Интегрирование тригонометрических функций
### Универсальная замена
$$\int R(\cos x,\ \sin x)\,dx\text{, где $R$ - рац. дробь}$$
Заменим $t = \tan \dfrac x 2$. $$\sin x = \dfrac {2\sin\dfrac x 2 \cos \dfrac x 2}{\cos^2 \dfrac x 2 + \sin^2 \dfrac x 2} = \dfrac {2\tan \dfrac x 2}{1 + \tan^2 \dfrac x 2} = \dfrac {2t} {1 + t^2}$$
$$\cos x = \dfrac {1 - t^2}{1 + t^2}$$

1) $R(-\sin x,\ \cos x) = -R(\sin x, \cos x) \implies t = \cos x$
2) $R(\sin, -\cos x) = -R(\sin x, \cos x) \implies t = \sin x$
3) $R(-\sin x, -\cos x) = R(\sin x, \cos x) \implies t = \tan x$

## Интеграл от дифференциального бинома 

> [!abstract] Дифференциального бинома
> $x^m(a + bx^n)^p\,dx$ - ==дифф. бином==. $a, b \neq 0$, $m, n, p \in \mathbb Q$

### Теорема: интеграл от дифф. бинома
**Теорема**
Интеграл "берётся" только в трёх случаях:
1) $p\in\mathbb Z$. Тогда заменим $x = t^k$, $k$ - общий знаменатель дробей $m$ и $n$
2) $\dfrac { m + 1}{n}\in \mathbb Z \implies a + bx^n = t^s$, где $s$ - знаменатель $p$
3) $p + \dfrac {m+1}{n} \in\mathbb Z$

# Определённый интеграл
## Определение
### Разбиение отрезка и интегральная сумма
> [!abstract] Разбиение отрезка
> Говорят, что точки $x_0, x_1, \dots, x_n$ образуют ==разбиение== отрезка $[a, b]$, если $a = x_0 < x_1 < \dots < x_n = b$. $\tau$ - разбиение. $\Delta x_k = x_k - x_{k - 1}, \ k = 1, \dots, n$ - длины отрезков разбиения, $\xi_k \in [x_{k-1}, x_k], \ k = 1, \dots, n$ - произв. точки.


> [!abstract] Интегральная сумма
> Пусть $f$ определена на $[a, b]$. Тогда $S(f, \tau, \xi) = S_\tau = \sum\limits_{k = 1}^n f(\xi_k) \Delta x_k$ - ==интегральная сумма==


> [!NOTE] Смысл интегральной суммы
> Смысл интегральной суммы - сумма площадей прямоугольников, построенных под графиком на отрезках разбиения


> [!abstract] Мелкость разбиения
> $\lambda \tau = \max \Delta x_k$ называется ==мелкостью разбиения==.

### Интегрируемость по Риману

> [!abstract] Интеграл по Риману
> Пусть $f$ определена на $[a, b]$. $f$ интегрируема по Риману  на $[a, b]$, если $\exists I \in \mathbb R: \forall \epsilon > 0 \exists \delta (\epsilon) > 0 : \forall \tau \forall \xi\ (\lambda\tau < \delta) \implies I = \int\limits_a^b f(x) \,dx$. $I$ - ==интеграл по Риману, или определённый интеграл==

#### Пример
Возьмём функцию Дирихле. $D(x)$ не интегрируема на $[a, b]$
1) $\left\{\xi_k\right\} \subset I = \mathbb R \diagdown \mathbb Q, f(\xi_k) = 0 \implies \forall \tau: S_\tau = 0$
2) $\left\{\xi_k\right\} \subset \mathbb Q, f(\xi_k) = 1, \forall \tau\ S_\tau = \sum\limits 1 \cdot \Delta x_k = b - a$


### Теорема о сумме интегралов
**Теорема**
Пусть $f$ и $g$ интегрируемы на $[a, b]$, и $\alpha, \beta \in \mathbb R$. Тогда $\int\limits_{a}^b (\alpha f + \beta g) \,dx = \alpha \int\limits_a^b f\,dx + \beta \int\limits_a^b g\,dx$

**Доказательство**
$$S(\alpha f + \beta g, \tau, \xi) = \sum\limits_{k = 1}^n(\alpha f (\xi_k) + \beta g(\xi_k))\Delta \xi_k = $$
$$= \alpha \sum\limits_{k = 1}^n f(\xi_k) \Delta x_k + \beta \sum\limits_{k = 1}^n g(\xi_k)\Delta x_k$$
$$|S(\alpha f + \beta g, \tau, \xi) - (\alpha\int\limits_a^b f + \beta \int\limits_a^b g)| = $$
$$= |\alpha S (f, \tau, \xi) + \beta S(g, \tau, \xi) - (\alpha\int\limits_a^b f + \beta \int\limits_a^b g)| \leq$$
$$\leq |\alpha|\left |S(f, \tau, \xi) - \int\limits_a^b f \right | + |\beta| \left | S(g, \tau, \xi) - \int\limits_a^b g \right | < \dfrac {\epsilon}{|\alpha| + |\beta|}$$ - так как $f$ - интегрируемо, поэтому $\forall\epsilon > 0 \exists \delta: \forall \tau \forall \xi (\lambda \tau \implies |S(f, \tau, \xi) - \int\limits_a^b f| < \epsilon$.

### Теорема _придумайте название_
**Теорема**
Если $f$ и $g$ интегрируемы на $[a, b]$ и $f\geq g$ на $[a, b]$,  то$\int\limits_a^b f \geq \int\limits_a^b g$

**Доказательство**
$$\forall \tau, \forall \xi: S(f - g, \tau, \xi) = \sum\limits_{k = 1}^n(f(\xi_k) - g(\xi_k))\Delta x_k \geq 0$$
По прошлой теореме $f - g$ - интегрируемо, то есть $$\exists \int\limits_a^b (f - g)$$-- то есть $$\forall \tau, \forall xi: S(f - g, \tau, \xi) \geq - \implies \int\limits_a^b (f - g) \geq 0$$
 
> [!TODO] Доказать дома
> Ребятки докажите за меня дома, на коллоке будет

По прошлой теореме $\int\limits_a^b (f - g) \geq 0$, то есть $\int\limits_a^b (f - g) = \int\limits_a^b f - \int\limits_a^b g \geq 0$

### Теорема об ограниченности интегрируемой на отрезке функции
**Теорема**
Если $f$ интегрируема по Риману на $[a, b]$, то она ограничена на $[a, b]$

**Доказательство**
От противного. Пусть $f$ - не ограничена. Тогда есть разбиение $\tau$, на одном из отрезков котого ($[x_{j - 1}, x_j]$) функция не ограничена. Тогда $S(f, \tau, \xi) = f(\xi_j) \Delta x_j + \sum\limits_{k = 1}^n f(\xi_k)\Delta x_k$
$$|S(f, \tau, \xi)| > |f(\xi_j)|\Delta x_j - |\sum\limits_{k = j} f(\xi_k) \Delta x_k|$$
Зафиксируем $\xi_k,\ k \neq j$. Можно подобрать $\xi_j$ так, что $|f(\xi_j)| > N, N \in \mathbb N$
Пусть $C =|\sum\limits_{k = j} f(\xi_k) \Delta x_k|$ . Тогда: 

$$|S(f, \tau, \xi)| > |f(\xi_j)|\Delta x_j - |\sum\limits_{k = j} f(\xi_k) \Delta x_k| > N\cdot x_k - C$$
Тогда $S\tau$ - ограничено. Противоречие.

## Критерий интегрируемости. Сумма Дарбу
### Сумма Дарбу
$M_k = \sup\limits_{x\in [x_{k - 1}, x_{k}]} f(x)$, $m_k = \inf\limits_{x\in [x_{k - 1}, x_{k}]} f(x)$

> [!abstract] Верхняя сумма Дарбу
> $\overline{S_\tau} = \sum\limits_{k = 1}^n M_k \Delta x_k$ называется ==верхней суммой Дарбу==


> [!abstract] Нижняя сумма Дарбу
> $\underline{S_\tau} = \sum\limits_{k = 1}^n m_k \Delta x_k$ называется ==нижней суммой Дарбу==

### Интегралы Дарбу 

> [!abstract] Интегралы Дарбу
> Обозначение $I_* = \sup\limits_\tau \underline{S_\tau}$ - ==нижний интеграл Дарбу==, $I^*$ - ==верхний интеграл Дарбу==.
- $\underline{S_\tau} \leq I_* \leq I^* \leq \overline{S_\tau}$
  ##### Доказательство
  $$\forall \tau_1 \tau_2: \underline{S_{\tau_1}} \leq \overline{S_{\tau_2}} \implies \sup_{\tau+1} S_{\tau_1} \leq \overline{S_{\tau_2}} \implies I_* \leq \inf\limits_{\tau_2} = I^**$$



### Теорема о неравенствах, связанных с суммами Дарбу
**Теорема**
Если $f$ опр. на $[a, b]$, то $\forall \tau_1, \tau_2\quad \underline{S_{\tau_1}} \leq \overline{S_{\tau_2}}$

**Доказательство**
$\tau = \tau_1 \cup \tau_2$
$\tau$ - измельчение $\tau_1$, $\tau_2$, то есть $\tau_1 \subseteq \tau$ и $\tau_2 \subseteq \tau$ и его мелкость меньше. Тогда $\overline{S_\tau} \leq \overline{S_{\tau_2}},\ \underline{S_{\tau_1}} \leq \underline{S_{\tau}}$
$$\underline{S_{\tau_1}} \leq \underline{S_\tau} \leq \overline{S_\tau} \leq \overline{S_{\tau_2}}$$

**Следствие**
$\forall\tau: \underline {S_\tau} \leq I_* \leq I^* \leq \overline{S_\tau}$

### Теорема: критерий интегрируемости
**Теорема**
Пусть $f$ - ограничена на $[a, b]$. $f$ интегрируема на $[a, b] \iff \forall\epsilon > 0 \exists \delta > 0\quad \forall\tau(\lambda_\tau < \delta \implies \overline{S_\tau} - \underline{S_\tau} \leq \epsilon)$

**Доказательство**
1. $\implies$
   Пусть $f$ интегрируема на $[a, b]$. Тогда по определению интегрируемости, $\exists\delta:\ \forall\tau,\xi(\lambda_\tau < \delta \implies|S(f_1\tau) - I| < \dfrac \epsilon 3)$ 
   $$S(f, \tau, xi) < I + \dfrac \epsilon 3$$  $$\sup\limits_{\xi} S(f, \tau, \xi) \leq I + \dfrac \epsilon 3$$$$\sup\limits_{\xi} S(f, \tau, \xi) = \overline{S_\tau}$$ Чтобы доказать это, воспользуемся свойствами $\sup$ и $\inf$. Тогда $\sum\limits_{k = 1}^n\sup A_k = \sum\limits_{k = 1}^n \sup f(\xi_k)\Delta x_k = \overline {S_\tau} = M_kX_k$. $\sup(A_1 + \dots + A_n) = \sup \left\{ \sum\limits_{k = 1}^n f(\xi_k)\Delta x_k \right\}$ $$I - \dfrac \epsilon 3 \leq \underline{S_\tau} \leq \overline{S_\tau} \leq I + \dfrac \epsilon 3$$
   Хотим получить: $I - \dfrac \epsilon 3 < \underline{S_\tau}\leq \overline{S_\tau} < I + \dfrac \epsilon 3$
   1) Рассморим левую часть неравенства из определения $I - \dfrac \epsilon 3 < S(f_1\tau_1)$, и возьмём $\inf$ по $\xi \implies I - \dfrac \epsilon 3 \leq \inf_\xi S(f_1\tau_1\xi) = \inf_\xi S(f_1\tau_1\xi)$.
      $$S_\tau = \sum\limits_{j = 1}^n \inf_{x\in [x_1, x_j]} f(x) \Delta x_j$$
      $$\sum\limits\inf_{x\in [x_1, x_j]} f(x)\Delta x_j = \inf_{(\xi_0, \dots, \xi_n)}\sum\limits_{j = 1}^n f(\xi_j)\Delta x_j$$
      $$S(f_1\tau_1\xi) < I + \dfrac \epsilon 3$$
      $$\overline{S_\tau} \leq I + \dfrac \epsilon 3 \implies I - \dfrac \epsilon 3 \leq \underline{S_\tau} \leq \overline{S_\tau} \leq I + \dfrac \epsilon 3$$
2. $\impliedby$
   $\underline{S_\tau} \leq I_* \leq I^* \leq \overline{S_\tau}$
   Знаем, что $\forall \epsilon > 0 \exists \delta: \forall \tau (\lambda_\tau < \delta \implies \overline{S_\tau} - \underline{S_\tau} < \epsilon)$
   $$\underline{S_\tau} \leq S_tau \leq \overline{S_\tau}$$
   $$|S_\tau - I_*| < \epsilon$$ - показано геометрически.
$\implies I_*$ - интеграл Римана (по определению интеграла).

**Следствие**
Если $f$ - интеграл по Риману на $[a, b]$, то $I_* = I^* = \int\limits_a^b f(x) \,dx$

### Теорема (без доказательства)
**Теорема**
$f$ интегрируема на $[a, b] \iff I_* = I^**\$, и при этом всегда $\int\limits_a^b f(x) \,dx = I_* = I^*$

### Теорема: аддитивность интегралов
**Теорема**
$\int\limits_a^b f(x)\,dx = \int\limits_a^c f + \int\limits_c^b f$, где $a \leq c \leq b$

**Доказательство**
Покажем сначала равносильность существования этих интегралов. Рассмотрим точку $c$ и возьмём произвольное разбиение отреза $[a, b]$ $\tau$. $c\in [x_{j - 1}, x_j]$. Рассмотрим вспомогательное разбиение отрезков: $\tau': a < x_1 < \dots < x_j < c$, $\tau'': c < x_j < \dots < b$.

1) Пусть $f$ интегрируема на $[a, b]$. Покажем, что $\exists\int\limits_a^c$  и $\exists\int\limits_c^b$
   $f$ интегрируема на $[a, b] \implies \overline{S_{\tau}} - \underline{S_\tau} < \epsilon$ для $\tau: \lambda_\tau < \delta(\epsilon)$
   $$\overline{S_\tau} \geq \overline{S_{\tau'} + \overline{S_{\tau''}}}$$ - очевидно, т.к. в одной из сумм справа $\sup f(x)$ может стать меньше
   $$\underline{S_\tau} \leq S_{\tau'} + S_{\tau''}$$ - очевидно
   $$\epsilon > \overline{S_\tau} - \underline{S_\tau} \geq \overline{S_{\tau'}} + \overline{S_{\tau''}} = (\underline{S_{\tau'}} + \underline{S_{\tau''}}) = (\overline{S_{\tau'}} - \underline{S_{\tau'}}) + (\overline{S_{\tau''}} - \underline{S_{\tau''}})$$
2) Пусть $f$ интегрируема на $[a, c]$ и $[c, b]$. Покажем, что $\exists \int\limits_a^b f$
   $$\overline{S_\tau} = \sum\limits_{k\neq j} + M_j \delta x_j,\ \underline{S_\tau} = \sum\limits_{k \neq j} m_j\Delta x_j$$ (на $j$-м отрезке находится точка $c$)
   
   Пусть $f$ ограничена на $[a, b]$ числами $B$ и $-B$.
   Хотим: $\overline{S_\tau}\geq \overline{S_{}\tau'} + \overline{S_{\tau''}}$
   $$(?)\quad \overline{S_\tau}\leq \overline{S_{\tau'}} + \overline{S_{\tau''}} + \text{что-то}$$
   $$\overline{S_\tau} - (\overline{S_{\tau'}} + \overline{S_{\tau''}}) = \left\{ \sum\limits_{k\neq j} \text{- сокращается}\right\}  = $$
   $$= M_j\Delta x_j - (\sup f(x)(c - x_{j -1})  + \sup_{[c ,x]}f(x) (x_j - c)) \leq$$
   $$\leq B\Delta x_j + B(c - x_{j - 1} + x_j - c) = 2B\Delta x_j \leq 2B\lambda_\tau $$
   Аналогично $\overline{S_\tau} \geq S_{\tau'} + S_{\tau''} - 2B\lambda_\tau$
   
   Таким образом, $\overline {S_\tau} \leq \overline{S_{\tau'}} + \overline{S_{\tau''}} + 2B\lambda_\tau$ и $\underline{S_\tau} \geq \underline{S_{\tau'}} + \underline{S_{\tau''}} - 2B\lambda_\tau$
   $$\overline{S_\tau} - \underline{S_\tau} \leq \overline{S_{\tau'}} + \overline{S_{\tau''}} + 2b\lambda_\tau - \underline{S_{\tau'}} - \underline{S_{\tau''}} + 2B\lambda_\tau = $$
   $$= (\overline{S_{\tau'}} - \underline{S_{\tau'}}) + (\overline{S_{\tau''}} \underline{S_{\tau''}}) + 4B\lambda_\tau < \epsilon$$
   $$\forall \epsilon > 0 \exists \delta(\epsilon): \forall \tau (\lambda_\tau < \delta\quad \overline{S_\tau} - \underline{S_\tau} < \epsilon)$$
   Возьмём $\delta = \min\left\{\delta_1(\dfrac \epsilon 3), \delta_2(\dfrac \epsilon 3), \dfrac \epsilon {3\cdot 4B}\right\}$

3)  Теперь покажем, что $\int\limits_a^b f = \int\limits_a^c f + \int\limits_c^b f$. 
   $$(?)\quad |\int\limits_a^b - (\int\limits_a^c + \int\limits_c^b)| < \epsilon$$
   $$|\int\limits_a^b - \left(\int\limits_a^c + \int\limits_c^b\right)+ (S_{\tau'} +S_{\tau''}) - (S_{\tau'} + S_{\tau''})| \leq $$
   $$\leq |\int\limits_a^b - (S_{\tau'} + S_{\tau''})| + |\int\limits_a^c - S_{\tau'}| + |\int\limits_c^b - S_{\tau''}| < \epsilon$$

### Утверждение о переопределении интегрируемой функции
**Утверждение**
Если изменить интегрируемую функцию $f$ в конечном числе точек, значение интеграла не изменится

**Доказательство**
Докажем для одной точки. Пусть значение переопределяется в точке $x_0$.  Заменим $f(x_0)$ на $c$. Рассмотрим $g(x) = \begin{cases} f(x), x\neq x_0 \\ f(x_0) - c, x = x_0\end{cases}$
$f(x) + g(x)$ - новая функция. Покажем, что $\int\limits_a^b g(x) =0$.
$\forall\tau\quad |S_\tau| \leq |c - f(x_0)|\cdot \lambda_\tau$. Но $\lambda_\tau \to 0 \implies \int\limits_a^b g(x) = 0$

## Классы интегрируемых функций
### Теорема об интегрируемости непрерывной функции
**Теорема**
Пусть $f$ непрерына на отрезке $[a, b]$. Тогда $f$ интегрируема на нём.

**Доказательство**
По теореме Кантора, непрерывная функция на отрезке равномерно непрерывна на нём. Тогда $\forall\epsilon > 0 \exists \delta(\epsilon) > 0 : \forall x', x'' \in [a, b]: (|x' - x''| < \delta) \implies |f(x') - f(x'')| < \epsilon$
$$(?)\quad \forall\epsilon' > 0 \exists \delta'(\epsilon): \forall \tau (\lambda_\tau < \delta' \implies \overline{S_\tau} - \underline{S_\tau} < \epsilon)$$
Рассмотрим $\tau: \lambda_\tau < \delta$ - из определения равномерной непрерывности.
$$\overline{S_\tau} - \underline{S_\tau} = \sum\limits_{k = 1}^n (M_k - m_k)\Delta xk$$
$\forall \xi', \xi'' \in [x_j, x_{j+H}]\quad |\xi' - \xi''| < \delta$, т.к. $\lambda_\tau < \delta$. Тогда $|f(\xi') - f(\xi'')|  < \epsilon$, что равносильно (доказательство позже) $M_j - m_j < \epsilon$. Но тогда $\sum\limits_{k = 1}^n (M_k - m_k)\Delta x_k \leq \epsilon \cdot \sum\Delta x_k = \epsilon (b - a)$

Доказательство равносильности.
1. $\impliedby$ 
    $M_j - m_j < \epsilon$ - знаем. $f(\xi') - f(\xi'') \leq M_j - m_j \leq \epsilon$
2. $\implies$
   $\forall \xi', \xi''\quad |f(\xi') = f(\xi'')| < \epsilon$. $\sup\limits_{\xi} (f(\xi') - f(\xi'')) = M_j - f(\xi'') \leq \epsilon$

# $X\ Y\ Z($
### Теорема об интегрируемости монотонной функкции
**Теорема**
Пусть $f$ - монотонна на $[a. b]$. Тогда $f$ - интегрируема на $[a, b]$.

**Доказательство**
Пусть б.о.о. $f$ - возрастает.
$(?)\quad \forall\epsilon > 0 \exists \delta: \forall \tau (\lambda_\tau < \delta \implies \overline{S_\tau} - \underline{S_\tau} < \epsilon)$
$$\overline{S_\tau} - \underline{S_\tau} = \sum\limits+{k = 1}^n (M_k - m_k \Delta x_k = \sum\limits_{k = 1}^n (f(x_k) - f(x_{k - 1}))\Delta x_k$$
Пусть $\exists \delta: \lambda_\tau < \delta$. Тогда $$\overline{S_\tau} - \underline{S_\tau} = \sum\limits_{k = 1}^n (f(x_k) - f(x_{k - 1}))\Delta x_k \leq \delta \cdot \sum\limits_1^n (f(x_k) - f(x_{k - 1})) \leq \epsilon$$ Возьмём $\delta < \dfrac \epsilon {f(b) - f(a)}$

### Следствия
1. Функции с конечным числом точек разрыва интегрируемы
2. Кусочно-монотонные функции интегрируемы
3. Можно рассмотреть интеграл, если функция не определена в конечном числе точек

### Теорема об интегрируемости  композиции функций
**Теорема**
Пусть $f$ - интегрируема на $[a, b]$, и принимает значение на отрезке $[c, d]$. Пусть $\varphi$ непрерывна на отрезке $[c, d]$.  Тогда $\varphi(f(x))$ инт. на $[a, b]$.

**Пример**
Для композиции интегрируемых теорема не работает. $\varphi = \begin{cases}1, x\neq 0\\ 0, x = 0\end{cases}, f(x) = \begin{cases} \dfrac 1 q, x = \dfrac p q\\ 0, x \notin \mathbb Q\end{cases}$
$D(x) = \varphi(f(x)) = \begin{cases} 0, x\notin \mathbb Q\\ 1, x\in \mathbb Q\end{cases}$

**Доказательство**
$\varphi$ равномерно непрерывна на $[c, d]$ (Кантор): $\forall\epsilon > 0 \exists\delta: \forall x', x''\in [c,d]\quad |\varphi(x') - \varphi(x'')| < \delta \implies |\varphi(x') - \varphi(x')|$
$(?)\quad \overline{S_\tau(\varphi(f))} - \underline{S_\tau (\varphi(f))} < \epsilon$. Знаем, что $f$ интегрируема. Тогда $(\lambda_\tau < \delta \implies \overline{S_\tau}(f) - \underline{S_\tau}(f) < \delta^2)$ - взли $\delta^2$ как $\epsilon$.

$$\overline{S_\tau}(\varphi(f)) - \underline{S_\tau}(\varphi(f)) = \sum\limits_{k = 1}^n (M_k(\varphi(f)) - m_k()\varphi(f))\Delta x_k$$
Поделим на два семейства индексов:
$$I = \left\{k: M_k(f) - m_k(f) - \delta \right\}$$$$II = k: M_k(f) - m_k(f) \geq \delta$$
1) $k \in I$. Тогда воспользуемся леммой $(\sup - \inf)$, $f(\xi') - f(\xi'') <\delta;\quad \xi'$, по равномерно непрерывной $\varphi: \xi'' \in [x_{k - 1}, x_k]$ $\implies |\varphi(f(\xi')) - \varphi(f(\xi''))| < \epsilon$ $\implies$ по этой же лемме $M_k(\varphi(f)) - m_k(\varphi(f)) < \epsilon$, $\sum\limits_{k \in I} (M_k(\varphi(f)) - m_k(\varphi(f)))\Delta x_k < \epsilon(b - a)$
2) $k \in II$. Рассмотрим $\overline{S_\tau}(f) - \underline{S_\tau}(f) < \delta^2$. $\sum\limits_{k\in II} (M_k(f) - m_k(f))\Delta x_k \leq \overline{S_\tau}(f) - \underline{S_\tau}(f) < \delta^2$. $\sum\limits_{k \in II} \Delta x_k < \delta^2$. $\sum\limits_{k \in II}(M_k(\varphi(f)) - m_k(\varphi(f)))\Delta x_k \leq 2l\cdot \sum\limits_{k \in II} \Delta x_k \leq 2l\cdot \epsilon$, где $l$ - ограничение по т. Вейерштрасса.
**Следствие**
$f$ инт. на $[a, b]$ $\implies |f|, f^k, k> 0$ - инт. на $f^k, k \leq 0$ - интегриуруема, если $f = 0$ в конечном числа точек.

### Теорема об интегрируемости произведения функций
**Теорема**
Пуссть $f, g$ - инт. на $[a, b]$. Тогда $f\cdot g$ инт. на $[a, b]$.

**Доказательство**
$(f - g)^2 = f^2 - 2fg + g^2$
1) Разность интегрируема
2) $f^2, g^2$ - по следствию предыдущей теоремы интегируемы.
$f \cdot g = \dfrac{f^2 - g^2 - (f - g)^2} 2$ - cумма интегрируемых функций.
##  Интеграл с переменным верхним пределом

> [!abstract] Интеграл с переменным верхним пределом
> Пусть $f$ инт. на $[a, b]$.  ($\implies \forall x \in (a, b)\quad \int\limits_a^x f(t)\,dt$ - существует.) Тогда $\Phi (x) = \int\limits_a^xf(t)\,dt$ - ==интеграл с переменным верхним пределом==.

### Теорема об ограниченности $\Phi$
**Теорема**
Пусть $f$ ограничена на $[a, b]$. Тогда $\Phi$ непрерывна и выполняется оценка $\exists C: |\Phi(x) - \Phi(y)| \leq C \cdot |x - y|,\ \forall x, y \in [a, b]$. - липшицевость.

**Доказательство**
Заметим, что из липшицевости следует непрерывность $\Phi$ (по определению непрерывности). Докажем только липшицевость.
Рассмотрим $|\Phi(x) - \Phi(y)| = |\int\limits_a^x f(t)\,dt - \int\limits^y_a f(t)\,dt| = |\int\limits_y^x f(t)\,dt|$.
Рассмотрим $|\sum f(\xi_k)\Delta x)k| \leq \sum |f(\xi_k)|\Delta x_k \implies |\int f| \leq \int |f|$. Тогда выражение сверху можно оценить:
$$|\int\limits_y^x f(t)\,dt| \leq \int\limits_x^y |f(t)|\,dt \leq \left\{ |f| \leq B\right\} \leq B \cdot \left | \int\limits_x^y \,dt \right |= B(x - y)$$

### Теорема о дифференцируемости $\Phi$
**Теорема**
Пусть $f$ непрерывна на $[a, b]$. Тогда $\forall x_0 \in (a, b)\quad \Phi'(x_0) = f(x_0)$

**Доказательство**
$\Phi' (x_0) = \lim\limits_{h\to 0} \dfrac{\Phi(x_0 + h) - \Phi(x_0)}{h}$
$$\dfrac{\Phi(x_0 + h) - \Phi(x_0)}{h} = \dfrac{x_0}{h} \pm \dfrac{f(x_0)}{h} \cdot h =$$$$= \dfrac{\int\limits_{x_0}^{x_0+h} f(t) \,dt - f(x_0)\cdot h}{h} + f(x_0) = \dfrac{\int_{x_0}^{x_0+ h} (f(t) - f(x_0))\,dt}{h} + f(x_0)$$
$$\left |\dfrac{|phi(x_0 + h) - \Phi(x_0)}{h} - f(x_0)\right | = \left | \dfrac{\int\limits_{x_0}^{x_0+h} (f(t) - f(x_0))\,dt}{h}\right| \leq $$$$\leq \dfrac 1 h \cdot \int\limits_{x_0}^{x_0+ h}|f(t) - f(x_0)|\,dt \leq \left \{ |t - x_0| \leq h\right \} $$
$f$ непрерывна: $\forall \epsilon > 0 \exists \delta: (|t - x_0| < \delta \implies |f(t) - f(x_0)| < \epsilon))$. Возьмём произв. $epsilon$ и найдём по нему $\delta$. Возьмём $h < \delta$:
$$\dfrac 1 h \cdot \int\limits_{x_0}^{x_0+ h}|f(t) - f(x_0)|\,dt \leq \left \{ |t - x_0| \leq h\right \} \leq \dfrac 1 h \int\limits_{x_0}^{x_0 + h} \epsilon\,dt = \epsilon$$
### Теорема: формула Ньютона-Лейбница
**Теорема**
Пусть $f$ интегрируема (в смысле определённого интеграла) на $[a, b]$ и имеет первообразную на этом отрезке на $[a, b]$ ($F' f$). Тогда $\int\limits_a^b f(x)\,dx = F(b) - F(a)$.

> [!tip] 
> Первообразная может быть и у неинтегрируемой по Риману функции: $F(x) = x^2\sin(\dfrac 1 {x^2}), x\in (0, 1]$. $F'(x) = 2x\cdot \sin\left(\dfrac 1 {x^2}\right)+ x^2\cdot \cos(\dfrac 1 {x^2})\cdot \left(\dfrac 2 {x^3}\right)= 2x\sin\left(\dfrac 1 {x^2}\right)- \dfrac 2 x \cdot\cos\dfrac{1}{x^2}$


**Доказательство**
Рассмотрим равномерное разбиение $[a, b]$ (на $n$ равных частей), $\dfrac{b - a}{n}$ - длина отрезка разбиения. Рассмотрим разность $$F(b) - F(a) = \sum\limits_1^n(F(x_k) - F(x_{k - 1})) =$$$$=\left \{ F(x_k) - F(x_{k - 1}) = F'(\xi_k)(x_k - x_{k - 1}) \text{ - т. Лагранжа}\right\} = $$$$= \sum\limits_1^n f(\xi_k) \Delta x_k = $$
$$= \sum\limits_1^n f(\xi_k) \cdot \dfrac{(b - a)}{n}$$
$$\lim\limits_{n \to \infty} (F(b) - F(a)) = \lim\limits_{n\to \infty}\sum\limits_1^n f(\xi_k)\dfrac {(b - a)}{n} = \int\limits_a^b f(x)\,dx$$

### Теорема - формула интегрирования по частям
**Теорема**
Пусть $u$ и $v$ - непрерывны и кусочно непрерывно дифференцируемы. 
$\int uv'\,dx = uv \bigg|_a^b - \int\limits_a^b vu'\,dx$

**Доказательство**
По условиям теоремы, оба интеграла существуют как интегралы от кусочно-непрерывной функции. 
$(uv)' = u'v + uv'$ - за исключением конечного числа точек.
$$\int\limits_a^b(uv)' = \int\limits_a^b u'v + \int\limits_a^b uv'$$
### Теорема: замена переменной
**Теорема**
Пусть функция $f$ непрерына на отрезке $[x_1, x_2]$, а функция $g$ - непрерывно дифференцируема на $[t_1, t_2]$, и $g(t_1) = x_1$, $g(t_2) = x_2$ и $g(t) \in [x_1, x_2], t\in [t_1, t_2]$. Тогда $\int\limits_{t1}^{t2} f(g(t))g'(t)\,dt = \int\limits_{x_1}^{x_2} f(x)\,dx$.

**Доказательство**
По условию $f$ - непрерывна. Тогда существует $F$ - первообразная $f$ - по теореме о дифференцируемости интеграла с переменным верхним пределом. (рассмотрим $|Phi(x) = \int\limits_{x_1}^x f(t)\,dt$ и $\Phi'(x) = f(x)$). Тогда по формуле Ньютона-Лейбница $\int\limits_{x_1}^{x_2} f(x)\,dx = F(x_2) - F(x_1)$. Рассмотрим функцию $F(g(t))$. Тогда $(F(g(t)))' = F'(g(t)) \cdot g'(t) = f(g(t)) \cdot g'(t)$. Тогда $F(g(t))$ - первообразная для $f(g(t))g'(t)$. Тогда по формуле Ньютона-Лейбница $\int\limits_{t_1}^{t_2} f(g(t)) g'(t) = F(g(t_2)) - F(g(t_1)) = F(x_2) - F(x_1)$.

## Теоремы о среднем

> [!abstract] Среднее значение функции на отрезке
> Предположим, что $f$ интегрируема на $[a, b]$. Предположим, что нужно посчитать её среднее значение на отрезке. $\lim\limits_{n\to \infty}\dfrac{\sum\limits_{k=1}^n f(\xi_k)}{n}$, где $\xi_k$ - точки с отрезков разбиения. Домножим и поделим на $(b - a)$. Тогда под пределом получается интегральная сумма для равномерного разбиения, делённая на $(b-a)$. Тогда получается $\dfrac{\int\limits_a^b f(x)\,dx}{b - a}$ - ==среднее значение функции на отрезке==.


> [!abstract] Среднее взвешенное функции на отрезке
> Пусть $\varphi(x)$ - весовая функция, т.е. $\varphi(x) \geq 0$ на $[a, b]$ и интегрируема. Тогда $\dfrac{\sum\limits_{k=1}^n\varphi (\xi_k)f(\xi_k)}{\sum\limits_{k=1}^n}\cdot \dfrac{(b - a) \cdot b}{(b - a)\cdot n}$ $= \dfrac {\int\limits_a^b f(x)\varphi(x)\,dx}{\int\limits_a^b \varphi(x)\,dx}$ называется ==средним взвешенным функции на отрезке==.


> [!NOTE] Замечание 
> Если $f$ непрерывна, то $f$ достигает $\min = m$ и $\max = M$, и по т. Коши о промежуточном значении $\exists \mu\in [m, M]: \exists x_0 \in [a, b] : \mu = f(x_0)$ 


### Первая теорема о среднем
**Теорема**
Пусть $f$ интегрируема на $[a, b]$, $\varphi$ - весовая функция ($\geq 0$ и интегрируема), и $m \leq f \leq M$ на $[a, b]$. Тогда $\exists\mu\in [m, M]$, $\mu \cdot \int\limits_a^b \varphi = \int\limits_a^b f \cdot \varphi$. (отношение вот этого на вот это это среднее взвешенное)

**Доказательство**
1) $\int\limits_a^b \varphi = 0$. Тогда $m\int\limits_a^b\leq \int\limits_a^b f \varphi \leq M\int\limits_a^b f\cdot \varphi\quad (*)$. Тогда $0 = 0$. 
2) $\int\limits_a^b \varphi \neq 0$. В $(*)$ поделим на $\int\limits_a^b \varphi$. Тогда $m \leq \dfrac{\int_a^b f\cdot \phi}{\int\limits_a^b \varphi} \leq M$
**Пример**
Важно, чтобы $\varphi$ сохраняла знак. Положим $f = x, \varphi = \text{sign } x$ на отрезке $[-1, 1]$. Тогда $\int\limits_{-1}^1 x\text{sign }x\,dx = 1$. Применим теорему. $\int\limits_{-1}^1 x\text{sign} x = \mu\int\limits_{-1}^1 \text{sign } x = 0$, поэтому теорема не работает.


### Вторая теорема о среднем
**Теорема**
Пусть на $[a, b]$ функция $f$ монотонно убывает (или возрастает), и $\varphi$ интегрируема. Тогда $\exists\xi in [a, b]: \int\limits_a^b f\cdot \varphi = f(a) \int\limits_a^\xi \varphi(x)\,dx + f(b)\int\limits_\xi^b \varphi(x)\,dx$

**Без доказательства.**


## Геометрические приложения интеграла
### Площадь под графиком
$\begin{cases} x = x(t) \\ y = y(t) \end{cases},\ t \in [t_1, t_2]$. Посчитаем $\int\limits_{x_1}^{x_2} y(x)$. $\int\limits_{x_1}^{x_2} y(x)\,dx = \left\{\begin{align} x = x(t) \\ \,dx = x'(t)\,dt\end{align}\right\} = \int\limits_{t_1}^{t_2} y(t)x'(t)\,dt$.

1) $x$ - непрерывно дифференцируема на $[t_1, t_2]$.
2) $y$ - непрерывно дифференцируема на $[x_1, x_2]$
3) Для $x(t)$ существует обратная функция $t(x)$ на $[t_1, t_2]$. Тогда $y(t) = y(t(x)) = y(x)$ 

### Длина дуги кривой

> [!abstract] Кривая
> ==Кривой== называется непрерывное отображение отрезка $[\alpha, \beta]$ на плоскость.

> [!abstract] Спрямляемая кривая
> Кривая $L$ называется ==спрямляемой==, если множество длин вписанных в неё ломаных $l$ ограничено сверху.

При добавлении к разбиению отрезка $[\alpha, \beta]$ новых точек ломаная становится длиннее, и её длина приближается к длине кривой. Тогда спрямляемость равносильна наличию длины у кривой.

Тогда длина ломаной равна сумме длин её отрезков. Тогда её можно посчитать по формуле $|l| = \sum\limits_{k=1}^n\sqrt{(x(t_k) - x(t_{k+1}))^2 + (y(t_k) - y(t_{k+1}))^2 }$. Пусть $x$ и $y$ непрерывно дифференцируемы. Тогда $x'$ и $y'$ - скорости, $(x', y')$ - вектор скорости. По теореме лагранжа: $|l| = \sum\limits_{k=1}^n\sqrt{(x'(\xi_k)\Delta t_k)^2 + (y'(\xi_k)\Delta t_k)^2}$ $= \sum\limits_{k=1}^n\sqrt{(x'(\xi_k))^2 + (y'(\eta_k))^2}\Delta t_k$. $|l| = \int\limits_a^b \sqrt{(x'(t))^2 + (y'(t))^2}\,dt$.

### Теорема о длине кривой
**Теорема**
Пусть $x(t)$ и $y(t)$ непрерывно дифференцируемы на $[\alpha, \beta]$. Тогда кривая $L = (x(t), y(t))$ - спрямляемая, и $|L| = \int\limits_\alpha^\beta \sqrt{(x'(t))^2 + (y'(t))^2}\,dt$

**Доказательство**
$(*)\ |l| = \left\{\text{по т. Лагранжа}\right\} =$ $\sum\limits_{k=1}^n \sqrt{(x'(\xi_k))^2 + (y'(\eta_k))^2}\Delta t_k$. Пусть $\sigma = \sum\limits_{k=1}^n \sqrt{(x'(\xi_k))^2 + (y'(\xi_k))^2}\Delta t_k$. Тогда $\sigma$ - интегральная сумма. Оценим $||L| - \sigma| = |\sum\limits_{k=1}^n(\sqrt{} - \sqrt{})\Delta t_k| \leq$  В каждом из выражений координата $x$ одинаковая. Тогда расстояние между ними равно разности координат $y$. $\left\{\text{по нер-ву труегольника}\right\}$ $\leq \sum\limits_{k=1}^n (y'(\xi_k) - y'(\eta_k))\Delta t_k$ $\leq \sum\limits_{k=1}^n(M_k - m_k)\Delta t_k = \overline S(y', \tau) = \underline S(y', \tau) \leq \varepsilon$, тогда $y'$ интегрируема, т.к. непрерывна.

Мы показали, что длина ломаной близка к интегральной сумме,  то есть $||l| - \sigma| < \varepsilon$ при мелких $\tau$. Тогда $(*) \leq B \cdot \sum\limits_{1}^n \Delta t_k$. Поэтому кривая спрямляема. Тогда $|l| \approx \sigma$ \approx \int\limits_a^b \dots. (интеграл из формулировки теоремы). Тогда $|l|\approx |L|$ (опр. $\sup$).

Покажем теперь, что $||L| - \int_\alpha^\beta| \leq |L| - |l||_{(1)} + ||l| - \int_\alpha^\beta|_{(2)}$ (первый интеграл из условия теоремы.). Оценим $(1)$ и $(2)$ по отдельности.
$(1)\ \forall\epsilon > 0 \exists l_e\quad |L| - |l_\epsilon| < \epsilon$. Если ломаная $l$ меньше, чем $l_\epsilon$, то мы вычтем больше $|L| - |l| < \epsilon$ю
$(2)\ ||l| - \sigma| + |\sigma - \int_\alpha^\beta| \leq 2\varepsilon$ (выше показано, что первое слагаемое при мелких $\tau$ меньше $\epsilon$ и второе меньше $\varepsilon$ по по определению $S$). Тогда выполняется, что $\forall \epsilon > 0\quad ||L| - \int_\alpha^\beta| \leq |L| - |l||_{(1)} + ||l| - \int_\alpha^\beta|_{(2)} < 3\varepsilon$. Но $\varepsilon$ можно взять любой, а разность фиксирована, поэтому она равна нулю. 

## Численное интегрирование
Пусть известно $k$ точек, в которых известны $f(x_k)$. Можно применить интерполяционный многочлен Лагранжа, построив многочлен $p(x)$. Тогда можно интегрировать $p(x)$.


> [!abstract] Разделённая разность
> ==Разделённой разностью== первого порядка в узлах $x_1, x_2$ называется выражение $f(x_1, x_2) = \dfrac{f(x_2) - f(x_1)}{x_2 - x_1}$. Разделённой разностью $k$-го порядка в узлах $x_1, \dots, x_{k+1}$ называется $\dfrac{f(x_2, \dots, x_{k+1}) - f(x_1, \dots, x_k)}{x_{k+1} - x_1}$.

Пример: разделённая разность 2-го порядка. Возьмём узлы $x_1, x_2, x_3$. $\dfrac{f(x_2, x_3) - f(x_1, x_2)}{x_3 - x_1}$.


> [!abstract] Интерполяционный многочлен в форме Ньютона
> $N(x) = f(x_0) + f(x_0, x_1)(x - x_0) + \dots + f(x_0, \dots, x_n)(x - x_0)\dots(x - x_{n-1})$

### Методы прямоугольников (многочлен 1-й степени)
1. Метод левых прямоугольников - взять функции в левом конце отрезка, и посчитать площадь получившегося прямоугольника.
2. Метод средних прямоугольников - взять среднее значение левого и правого конца отрезков.
3. Метод правых прямоугольников.

### Метод трапеций
Многочлен первой степени. Посчитать площадь трапеции, построенной на точках $x_1, x_n, p(x_1), p(x_n)$. Тогда формула многочлена - $N(x) = f(x_1) + f(x_1, x_2)(x - x_1)$ $= f(x_1) + \dfrac{f(x_2) - f(x_1)}{x_2 - x_1}(x - x_1)$. Проинтегрируем от $a = x_1$ до $b = x_2$: $f(a)b + \dfrac{f(b) - f(a)}{2}(b + a) - f(b)a$

# Несобственный интеграл

> [!abstract] Несобственный интеграл первого рода
> ==Несобственным интегралом первого рода== называется $\lim\limits_{b\to +\infty} \int\limits_a^b f(x)\,dx = \int\limits_a^{+\infty}f(x)\,dx$. Здесь предполагается, что $\forall b:$ $f$ интегрируема на $[a, b]$


> [!abstract] 
> Пусть $\omega in \mathbb R$. ==Несобственным интегралом второго рода== называется $\lim\limits_{b\to \omega} \int\limits_a^b f(x)\,dx = \int\limits_a^\omega f(x)\,dx$. Аналогично, $\forall b\in [a, \omega):$ $f$ интегрируема на $[a, b]$.


> [!tip] Отличие от интеграла Римана
> $f$ может быть не ограничена в окрестности $\omega$. Рассмотрим $\int\limits_0^1\dfrac{\,dx}{\sqrt{x}} = \lim\limits_{a\to 0} \int\limits_a^1\dots = \lim\limits_{a\to 0} 2\sqrt{x} \bigg |^1_a$ = $\lim\limits_{a\to 0} 2 (1 - \sqrt{a}) = 2$


> [!abstract] Сходящийся несобственный интеграл
> Говорят, что несобственный интеграл ==сходится==, если $\exists\lim \in \mathbb R$. Иначе - ==расходится===


> [!tip] 
> Несобственный интеграл 2-го рода можно свести к 1-му роду. Пусть $\omega \in \mathbb R$. Тогда $\int\limits_a^\omega f(x)\,dx = \left\{ \begin{align} t = \dfrac{1}{\omega - x}\\ \,dt = \dfrac{1}{(\omega - x)^2}\,dx = \dfrac{1}{t^2}\,dx \end{align}\right\}$

### Теорема: критерий Коши сходимости несобственного интеграла
**Теорема**
$\forall\epsilon > 0 \exists b_\epsilon: \forall b', b''\quad (b_\epsilon < b' < b'' < \omega) \implies |\int\limits_{b'}^{b''} f(x)\,dx| < \epsilon$

**Без доказательства**

### Связь с другими интегралами

> [!warning] Связь интеграла Римана и несобственного интеграла
> Если $f$ интегрируема по Риману на $[a, b]$, то существует несобственный интеграл второго рода, и он совпадает с собственным (т.е. интегралом Римана).

### Теорема: аддитивность по промежутку
**Теорема**
Пусть $a < c < \omega$. Тогда $\int\limits_a^\omega f(x)\,dx$ и $\int\limits_c^\omega f(x)\,dx$ сходятся или расходятся одновременно. Если они сходятся, то выполняется свойство аддитивности по промежутку, то есть $\int\limits_a^\omega = \int\limits_a^c + \int\limits_c^\omega$

**Доказательство**
$\forall b \in [a, \omega)$ имеем аддитивность: $\int\limits_a^b f = \int\limits_a^c f + \int\limits_c^b f$. Очевидно, что эти интегралы либо сходятся, либо расходятся одновременно. Тогда $\int\limits_a^\omega$ сходится. Воспользуемся свойством пределов: $\lim\limits_{b\to \omega} \int\limits_a^b f = \lim\limits_{b\to \omega} \left(\int\limits_a^c + \int\limits_c^b\right)= \int\limits_a^c+\lim\limits_{b\to \omega}\int\limits_c^b$.

### Теорема: линейность несобственного интеграла
**Теорема**
Пусть $\int\limits_a^\omega f$ и $\int\limits_a^\omega g$ сходятся. Тогда $\int\limits_a^\omega(\alpha f + \beta g) = \alpha\int\limits_a^\omega f + \beta \int\limits_a^\omega g$

**Доказательство**
Доказать дома))))))

### Свойства интеграла Римана, которые не переносятся на несобственный интеграл
**Интегрируемость произведения интегрируемых функций**
$\int\limits_0^1 \dfrac{\,dx}{\sqrt x}$ - сходится. В случае интеграла Римана - $\int\limits_a^b f\cdot g$ существует, если $f$ и $g$ интегрируемы. Тогда $\int\limits_0^1 \dfrac 1 {sqrt{x}} \cdot \dfrac{1}{\sqrt x} \,dx = \int\limits_0^1 \dfrac 1 x \,dx = \ln x \bigg |^1_0 = +\infty$.

**Теорема о композиции функций**
$f$ - интегрируема по Риману $\implies$ $|f|$ интегрируема по Риману. Для несобственных интегралов это не выполняется. Пример: построим такую $f$, что $\int\limits_1^{+\infty} f$ сходится, а $\int\limits_1^{+\infty} |f|$ расходится. _Дома рассмотреть ступенчатые функции, то есть $f = \dfrac {(-1)^n}{n},\ x \in [n, n + 1]$. Тогда $\int\limits_1^{+\infty} f = \sum\limits+1^{+\infty} \dfrac{(-1)^n}{n}$._ Рассмотрим числовую ось, отметим на ней числа $1,\ 2,\ 3,\ 4,\ \dots$. Поделим отрезок $[1, 2]$ на две части: в левой части положим $f = 1$, в правой - $f = -1$. Отрезок $[2, 3]$ поделим на четыре части и положим функцию равной $1$ и $-1$ попеременно. На отрезке $[3, 4]$ - 6 частей. Таким образом, на отрезке $[k, k+1]$ будет $2k$ равных частей. Покажем, что интеграл от такой функции - сходится, а интеграл от $|f|$ - расходится. Рассмотрим $b\in [1, +\infty)\quad \int\limits_1^b f(x)\,dx = \int\limits+1^k + \int\limits_k^b = 0 + \int\limits_k^b$. Предположим, что $b$ принадлежит $j$-ому отрезку разбиения, где $1\leq j \leq 2k$. Рассмотрим 2 случая:
1. Пусть $j$ - нечётно. Тогда $\int\limits_k^b = \int\limits_k^u + \int\limits_u^b \leq \dfrac 1 {2k} \to 0$, где $u$ - начало $j$-го отрезка. 
2. Пусть $j$ - чётно. Тогда $\int\limits_k^b = \int\limits_k^{j - 1} + \int\limits_{j - 1}^{j} + \int\limits_u^b \leq \dfrac 1 {2k} \to 0$, где $u$ - начало $j$-го отрезка.

## Признаки сходимости несобственных интегралов

> [!abstract] Абсолютно сходящийся интеграл
> Несобственный интеграл -- ==абсолютно сходящийся==, если $\int\limits_a^\omega |f|$ сходится.

### Теорема об абсолютной сходимости
**Теорема**
Если $\int\limits_a^\omega |f|$ сходится, то $\int\limits_a^\omega$ сходится.

**Доказательство**
$\int\limits_{b'}^{b''} |f| < \epsilon \implies |\int\limits_{b'}^{b''} f| < \epsilon$ - по критерию Коши.

### Теорема: первый признак сравнения
**Теорема**
Пусть $f$ и $g$ $\geq 0$ на $[a, \omega)$, и $f(x) \leq g(x),\ x \in [a, \omega)$. Тогда:
1) $\int\limits_a^\omega g$ сходится $\implies$ $\int\limits_a^\omega f$ сходится
2) $\int\limits_a^\omega f$ расходится $\implies$ $\int\limits_a^\omega g$ расходится

**Доказательство**
1) $\int\limits_a^b f(x)\,dx$ - не убывает по верхнему переделу $b$, т.к. $f\geq 0$. Тогда по теореме о пределе монотонной функции, если интегралы $\int\limits_a^b f$ ограничены сверху, то $\exists \int\limits_a^\omega f$. Тогда $\int\limits_a^b f \leq \int\limits_a^b g  \leq \int\limits_a^\omega g$
2) От противного. Пусть $\int\limits_a^\omega f$ - расходится и $\int\limits_a^\omega g$ сходится. Но тогда $\int\limits_a^\omega f$ сходится по первому пункту, т.е. получили противоречие.

### Теорема: второй признак сравнения
**Теорема**
Пусть $f$ и $g$ $> 0$ на $[a, \omega)$ и $\exists c_1, c_2 > 0$ такие, что $c_1 \cdot g \leq f \leq c_2 \cdot g$ на $[a, \omega)$. Тогда $\int\limits_a^\omega f$ и $\int\limits_a^\omega g$ сходятся или расходятся одновременно.
**Доказательство**
1) Предположим, что $\int\limits_a^w f$ сходится. Воспользуемся оценкой $c_1\cdot g \leq f$. По первому признаку $\int\limits_a^\omega f$ сходится, поэтому $\int\limits_a^\omega g$ сходится
2) Пусть $\int f$ - расходится. Используем правую оценку и первый признак сравнения.
3) _дома аналогично_
4) _дома аналогично_

### Теорема: признак сравнения в предельной форме
**Теорема**
Если $\lim\limits_{x \to \omega} \dfrac{f(x)}{g(x)} = C > 0$, то $\int\limits_a^\omega f$ и $\int\limits_a^\omega g$ сходятся или расходятся одновременно.

**Доказательство**
Пусть $|\dfrac f g - C| < \epsilon$. Тогда $\epsilon = \dfrac C 2$:
$$- \dfrac C 2 < \dfrac f g - C < \dfrac C 2$$
$$\dfrac C 2 < \dfrac f g < \dfrac 3 2 C$$
при этом $x \in O(\omega)$. Доказано по второму признаку сравнения.

### Теорема: Формула Ньютона-Лейбница
**Теорема**
Пусть $f$ имеет первообразную на промежутке $[a, \omega)$. Пусть $\int\limits_a^\omega$ существует. Тогда справедлива формула Ньютона-Лейбница: $\int\limits_a^\omega f = F \bigg | ^\omega_a = \lim\limits_{b\to \omega} (F(b) - F(a))$.

**Доказательство**
$\int\limits_a^b f = F\bigg |^b_a$, поэтому применим обычную формулу Н-Л с пределом:
$$\lim\limits_{b\to \omega} \int \limits_a^b f = \lim\limits_{b\to \omega} F \bigg |^b_a$$

### Теорема: интегрирование по частям
**Теорема**
Пусть $u, v$ - непр. на $[a, \omega)$ и кусочно непрерывно дифференцируемы на $[a, \omega)$.  $U$ - первообразная функции $u$, а функция $v$ - имеет непрерывную производную. 
Предположим, что сходится интеграл:
$$\int\limits_a^\omega U(x)u'(x)dx$$
Также пусть $\exists\lim\limits_{b\to \omega} u(b)v(b)$
Тогда справедливо:  
$$\int\limits_a^\omega u\,dv = uv\bigg | ^\omega_a - \int\limits_a^\omega v\,du \quad (*)$$
**Доказательство**
Согласно форме интегрирования по частям для собственных интегралов при каждом $\omega' < \omega$ справедливо равенство
$$$\int\limits_a^{\omega'} udv  = uv\bigg | ^{\omega'}_a - \int\limits^{\omega'}_a vdu$$
Переходя в котором к пределу при $\omega' \rightarrow \omega-0$ переходм к предположению в теореме $(*)$.

### Теорема: признак Дирихле
**Теорема**
Пусть $f$ непрерывна на $[a, \omega)$ и её первообразная $F$ ограничена на $[a, \omega)$. Пусть $g$ - непрерывно дифференцируема на $[a, \omega)$ и $g \to 0$, когда $x \to \omega$

**Доказательство**
$\int\limits_a^\omega f\cdot g = \int\limits_a^\omega F'\cdot g = Fg\bigg |^\omega_a - \int \limits_a^\omega F \cdot g'$. Нужно доказать, что $\int\limits_a^\omega F'\cdot g$ сходится. Рассмотрим $\lim\limits_{b\to\omega} F(a)g(b) - F(a)g(a)$. Этот предел равен нулю. Теперь рассмотрим второй интеграл $\int\limits_a^\omega F\cdot g'$. Пусть $F$ ограничена константой $M$. Тогда $$-M\left |\int\limits_a^\omega g'\right | \leq \int\limits_a^\omega F \cdot g' \leq M \cdot \left | \int\limits_a^\omega g'\right |$$
$$\int\limits_a^\omega g' = g(\omega) - g(a) = \lim\limits_{b\to \omega} g(b) = 0$$
$$-M\left |g(a)\right| \leq \dots \leq M\left | g(a)\right |$$


> [!error] Кто-то все намешал
> См. Телековского Теорему 9.10.8 (ст. 75) она вытекает из теоремы 9.10.7 (ст.74) которая вытекает из теоремы интегрирования по частям. $\quad$ Певел

### Теорема: признак Абеля
**Теорема**
Пусть $f$ непр ан $[a, \omega)$ и $\int\limits_a^\omega$ сходится. Пусть $g$ - непр. дифф. на $[a, \omega)$б монотонна и ограничена на этом же промежутке. Тогда $\int\limits_a^\omega f \cdot g$ сходится

**Доказательство**
$\int\limits_a^\omega f\cdot g$. $f$ непр. $\implies$ есть первообразная $F$. Тогда $\int\limits_a^\omega = F(\omega) - F(a)$. Теперь нужно показать, что первообразная ограничена. По условию этот интеграл сходится, поэтому $F(\omega)$ - конечно. $\lim\limits_{b\to \omega} F(b)$. Заметим, что $F$ - непр. как интеграл с переменным верхним пределом. Тогда на любом промежутке $[a, b]$ $F$ - ограничена. (разбиваем промежуток $[a, \omega)$) на промежуток $[a, b]$ и $[b, \omega)$. На $[b, \omega]$ $F$ ограничена по определению предела. Поэтому $F$ огр. на $[a, \omega)$. Поэтому $f$ удовлетворяет условию признака Дирихле. $g$ - монотонна и ограничена $\implies$ $\exists\lim\limits_{b\to \omega} g(b)$ = C. Рассмотрим $h(x) = g(x) - C$. Понятно, что $h$ - непр.дифф. и $h\to 0$, когда $x\to \omega$, поэтому $h$ тоже удовлетворяет условиям признака Дирихле.

Рассмотрим интеграл $\int\limits_a^\omega f\cdot g =$$= \int\limits_a^\omega f(g - c) + \int\limits_a^\omega f \cdot c$ - сходится по признаку Дирихле $\implies$ данный интеграл сходится.

# Ряды


> [!abstract] Ряд
> $\sum\limits_{k = 1}^\infty a_k$ - ==ряд==

## Сходимость ряда

> [!abstract] Сходимость ряда
>  $\sum\limits_1^\infty a_k$ ==сходится==, если $\exists\lim\limits_{K\to \infty} \sum\limits_{k = 1}^K a_k$


> [!abstract] Ряд Лейбница
> $\sum (-1)^k a_k$, где $a_k \to 0, a_k \geq 0$. Этот ряд сходися.

### Теорема: интегральный признак Коши-Маклорена
**Теорема**
![](attachments/Pasted%20image%2020230421120259.png)
Пусть $f$ - убывает к нулю на $[1, +\infty)$. Тогда $\sum\limits_{k =1 }^{+\infty} f(k)$ сходится или расходится одновременно с интегралом $\int\limits_1^{+\infty} f$.
**Доказательство**
![](attachments/Pasted%20image%2020230421120220.png)
![](attachments/Pasted%20image%2020230421120158.png)

### Лемма: преобразования Абеля
**Лемма**
$\sum\limits_{k = 1}^n a_k b_k = S_n$. $B_j = \sum\limits_{k = 1}^j b_k, j = 1, \dots, n$. $B_0$ - выбранное число.

**Доказательство**
$\sum\limits_{k = 1}^N = \left\{ \begin{align}b_k = B_k - B_{k -1} =\\ = \sum\limits_{m =1}^k b_m - \sum\limits_{m = 1}^k b_m = b_k\end{align} \right \} = \sum\limits_{k = 1}^n a_k (B_k - B_{k - 1}) = \sum\limits_{k = 1}^n a_k b_k - \sum\limits_{k =1}^n a_k B_{k-1}$
$\sum\limits_{k=1}^n a_kB_{k-1} = \begin{align} m=k - 1\\ k=m +1\end{align} = \sum\limits_{k = 0}^{n - 1} a_{m+1}B_m = \sum\limits_{k = 0}^{n-1}a_kB_k = a_1B_0 + \sum\limits_{k=1}^{n-1}a_{k+1}B_k =$
$= a_nB_n - a_1B_0 + \sum\limits_{k=1}^{n-1}(a_kB_k - a_{k+1}B_k) = a_nB_n - a_1B_0 - \sum\limits_{k = 1}^{n-1}B_k(a_{k+1} - a_k)$
****
Преобразования Абеля - аналог интегрирования по частям для рядов.  $B_j$ - аналог первообразной для $b$. $\int\limits_1^i f(x) = \sum\limits_{m = 1}^{j - 1} b_m = B_{j - 1}$, при $B_0 = 0$ 

$a_{k + 1} - a_k = \dfrac{a(k + 1) - a(k)}{(k + 1) - k}$ - аналог производной

$a(n)B(n) - a(1)B(0) - \sum\limits_{k=1}^{n+1} B(k)a'(k)$ - аналог интеграла.

### Теорема: признак Дирихле
**Теорема**
Пусть $\sum\limits_{k=1}^\infty$ - ряд. Пусть:
1) $a_k$ монотонна и стремится к нулю при $k\to\infty$
2) $\exists M: \forall N\ |B_N| = |\sum\limits_{k =1}^N b_k| \leq M$
Тогда $\sum\limits a_k b_k$ - сходится.

**Доказательство**
Запишем преобразование Абеля: $B_0 = 0$, $\sum\limits_{k=1} a_k b_k = a_nB_n - \sum\limits_{k=1}^{n-1} B_k(a_{kH} - a_k)$
$|\sum\limits_{k=1}^{n-1} B_k(a_{kH} - a_k)| \leq M\sum\limits_{k=1}^n|a_{k+1 - a_k}| =$ $= \left \{ a_k\text{- монотонны}\right \} = M|\sum\limits_{k = 1}^{n-1}(a_{k+1} - a_k)| =$ $ $= M|a_n - a_1| \to M|a_1|$ - конечное число $\implies$ $\sum\limits_{k=1}^{n-1} B_k(a_{kH} - a_k)$ - сходится.

$|\sum\limits_1^{n-1} B_k(a_{k+1} - a_k)| \leq \sum\limits_1^{n-1} |B_k| |a_{k+1} - a_k| \leq C$ - сходится по монотонности последовательности

### Теорема: признак Абеля
**Теорема**
Пусть $a_k$ - ограничено и $\sum\limits_1^\infty b_k$ сходится. Тогда $\sum\limits_1^\infty a_k b_k$ сходится.

**Доказательство**
$a_k$ - монотонна и ограничена $\implies$ по теореме о монотонной последовательности $\exists a = \lim\limits_{n \to +\infty} a_n$.
$h_k = a_k - a \to 0, k \to \infty$ - монотонна.
$\sum a_k b_k = \sum (h_k + a) b_k = \sum h_k b_k + a\sum b_k$. Первый ряд сходится по признаку Дирихле, второй - по условию.

## Перестановка слагаемых в рядах

> [!abstract] Абсолютно сходящийся ряд
> $\sum a_k$ - ==абс. сходящийся==, если $\sum |a_k|$ сходится.


> [!abstract] Условно сходящийся ряд
> $\sum a_k$ - ==сходится условно==, если он сходится, но не абсолютно.


Рассмотрим ряд $\sum a_k$. Пусть $\sum a_k^*$ - перестановка этого ряда. 

### Теорема
**Теорема**
Пусть $\sum a_k$ сходится абсолютно. Тогда любая перестановка $\sum\limits a_k^*$ сходится к той же сумме.

**Доказательство**
Дано, что $\sum |a_k|$ сходится. Рассмотрим частичную сумму $\sum\limits_1^n |a_k^*| \leq \sum\limits_{k = 1}^\infty |a_k|$, так как $a_k^*$ - подмножество $a_k$. Но тогда по теореме о монотонной последовательности ряд из модулей $\sum |a_k|$ сходится, то есть $\sum a_k^*$ сходится.

Пусть $S$ - cумма исходного ряда $\sum\limits_1^\infty a_k$, $S_n$ - его частичная сумма, $S_n^*$ - частичная сумма этого ряда с перестановками.

Так как $S$ - сходится, то $\exists N: \forall n > N:\ |S - \sum\limits_{k=1}^\infty a_k| < \dfrac \epsilon 2$, то есть $|S - S_n| < \dfrac \epsilon 2$. Но $\exists M : \left\{ a_1, \dots, a_N\right\} \subseteq \{a_1^*, \dots, a_M^*\}$.
$|S_M^* - S_N| = |\sum\limits_{k = 1}^M a_k^* - \sum\limits_{k = 1}^N a_k| \leq \sum\limits_{N+1}^\infty |a_k| < \dfrac \epsilon 2$

### лемааа
**Лемма**
Пусть $\sum\limits a_k$ сходится условно. Тогда пусть $a_k^+ = \begin{cases} a_k,\ a_k \geq 0 \\ 0,\ a_k < 0\end{cases}$ и $a_k^- = \begin{cases} a_k,\ a_k \leq 0\\ 0, a_k > 0\end{cases}$
Тогда $\sum\limits a_k^+$ и $\sum\limits a_k^-$ расходятся

**Доказательство**
$a_k = a_k^+ + a_k^-$. От противного, пусть $\sum\limits a_k^+$ сходится. Но тогда $\sum\limits a_k^-$ сходится. Но тогда $\sum\limits |a_k|$ сходится. Противоречние

### Теорема Римана
**Теорема**

**Доказательство**
Фиксируем произвольное $A$. Уберём из $a_k^+$ и $a_k^-$ нулевые элементы. Тогда $\alpha_k > 0\ (a_k^+) - \beta_k\ (a_k^-) \neq 0$. Тогда $\sum\limits \alpha_k \to \infty$ и $\sum\limits -\beta_k \to -\infty$ ,и $\alpha_k \to +\infty$ ,и $-\beta_k \to 0$.
1) Берём какие-то первые $\alpha_k$. Останавливаемся тогда, когда $\sum\limits_1^{N_1} \alpha_k > A$.
2) Берём первые $-\beta_k$. Останавливаемся тогда, когда в сумме $> A$.

# Функциональные последовательности и ряды
## Функциональная последовательность

> [!abstract] Функциональная последовательность
> Пусть каждому $n \in \mathbb N$ сопоставлена некоторая функция $f_n(x)$, определённая на множестве $X$. Тогда $f_n(x)$ - ==функциональная последовательность== на множестве $X$.

### Примеры
- $f_n(x) = x^n,\ X = [0, +\infty)$
- $f_n(x) = \sum\limits_{k =1}^n \dfrac{1}{k + x},\ X = (-1, +\infty)$

Если фиксировать $x = x_0$ и менять $n$, то получается обычная числовая последовательность. Если фиксировать $n_0$ и менять $x$, то получится функция $f_{n_0}(x)$

### Равномерная и поточечная сходимость

> [!abstract] Поточечная сходимость
> Пусть $\forall x_0 \in X$ числовая последовательность $f_n(x_0)$ сходится. Обозначим этот предел как $f(x_0)$. Получаем функцию $f$, определённую на $X$: $$f(x_0) := \lim\limits_{n\to +\infty} f_n(x_0)$$
> 
> Тогда последовательность $f_n(x)$ ==сходится поточечно== к функции $f(x)$ на $X$. Таким образом, это определение представляет собой: $$\forall x \in X\ \forall \epsilon > 0\ \exists N = N(\epsilon, x): \forall n > N\ |f_n(x) - f(x)| < \epsilon$$


> [!abstract] Равномерная сходимость
> Последовательность $f_n(x)$ ==равномерно сходится== на $X$ к функции $f$, если $$\forall\epsilon > 0\ \exists N = N(\epsilon): \forall x \in X\ \forall n> N\ |f_n(x) - f(x)| < \epsilon$$. Обозначение: $f_n(x) \rightrightarrows f(x),\ x\in X$.


> [!attention] Восклицательный знак
> Очевидно, что поточечная сходимость следует из равномерной. Поэтому при исследовании функциональной последовательности на равномерную сходимость единственный возможный равномерный предел - это поточечный предел.


> [!tip] 👊
> Используя неравенство треугольника, нетрудно показать, что если $f_n(x) \rightrightarrows f(x)$ и $g_n(x) \rightrightarrows g(x)$ на $X$, то $\forall \alpha, \beta \in \mathbb R$: $$\alpha f_n(x) + \beta g_n(x) \rightrightarrows \alpha f(x) + \beta g(x),\ x \in X$$

### Теорема: критерий равномерной сходимости
**Теорема**
$f_n(x) \rightrightarrows f(x),\ x \in X \iff$ $\iff \forall\epsilon > 0 \exists N = N(\epsilon) : \forall n > N\ \sup\limits_{x\in X} |f_n(x) - f(x)| < \epsilon$, то есть $\lim\limits_{n \to +\infty} \sup\limits_{x\in X} |f_n(x) - f(x)| = 0$

**Доказательство**
$\implies$. Знаем, что $\forall\epsilon > 0 \exists N = N(\epsilon): \forall x \in X \forall n > N |f_n(x) - f(x)| < \epsilon$. Так как это неравенство выполняется для всех $x$, то оно выполняется и для $x$, при котором достигается $\sup |f_n(x) - f(x)| < \epsilon$. 

$\impliedby$. Имеем, что $\forall\epsilon > 0 \exists N = N(\epsilon): \forall n > N\ \sup\limits_{x\in X} |f_n(x) - f(x)| < \epsilon$. Если $\sup\limits_{x\in X} |f_n(x) - f(x)| < \epsilon$, то очевидно, и $\forall x \in X\ |f_n(x) - f(x)| < \epsilon$

### Теорема: критерий Коши равномерной сходимости
**Теорема**
$f_n(x) \rightrightarrows f(x),\ x \in X$ $\iff$ $\iff \forall\epsilon > 0 \exists N = N(\epsilon): \forall x \in X\ \forall n, m > N\ |f_n(x) - f(x)| < \epsilon$

**Доказательство**
$\implies$. Знаем, что $\forall\epsilon > 0 \exists N = N(\epsilon):\ \forall x \in X\ \forall n > N\ |f_n(x) - f(x)| < \epsilon$. По неравенству треугольница, $|f_n(x) - f_m(x)| \leq |f(x) - f_n(x)| + |f(x) - f_m(x)|$. ![](attachments/Pasted%20image%2020230514163708.png)

$\impliedby$. Имеем $$\forall\epsilon > 0\ \exists N = N(\epsilon): \forall x \in X\ \forall n, m > N\ |f_n(x) - f_m(x)| < \epsilon$$
Зафиксируем точку $x$. Тогда по критерию Коши для предела функции в каждой точке существует $\lim\limits_{n\to +\infty} f_n(x) = f(x)$. Возьмём $\epsilon = \dfrac{\epsilon'}{2}$Знаем, что $$\forall x \ \in X:\ \exists n, m > N\ |f_n(x) - f_m(x)| < \dfrac{\epsilon'}{2}$$Зафиксируем $n > N$. Тогда $$\forall m > N:\ \forall x \in X\ |f_n(x) - f_m(x)| < \dfrac{\epsilon'}{2}$$Перейдём к пределу по $m$: $$\forall x \in X\ \lim\limits_{m\to +\infty}|f_n(x) - f_m(x)| = |f_n(x) - f(x)| \leq \dfrac{\epsilon'}{2} < \epsilon'$$Тогда получим: $$\forall\epsilon' > 0\ \exists N = N(\epsilon'): \forall x \in X\ \forall n > N\ \ |f_n(x) - f(x)| < \epsilon'$$

## Функциональный ряд

> [!abstract] Функциональный ряд
> Ряд вида $\sum\limits_{k = 1}^{+\infty} a_k(x)$ называется ==функциональным рядом==. При фиксированных $x$ это обычный числовой ряд.

> [!abstract] Сходимость функционального ряда
> Ряд $\sum\limits_{k = 1}^{+\infty} a_k(x)$ ==сходится== поточечно/равномерно на множестве $X$, если на нём поточечно/равномерно сходится последовательность его частичных сумм $\sum\limits_{k=1}^n a_k(x)$.

## Признаки равномерной сходимости функциональных рядов

### Теорема: признак Вейерштрасса
**Теорема**
Пусть на множестве $X$ заданы ряды $\sum\limits_{k=1}^{+\infty} a_k(x)$ и $\sum\limits_{k=1}^{+\infty} b_k(x)$. При этом $\forall x \in X$ и $k \in \mathbb N$: $$|a_k(x)| \leq b_k(x)$$
Если ряд $\sum\limits_{k=1}^{+\infty}b_k(x)$ равномерно сходится на $X$, то $\sum\limits_{k=1}^{+\infty}a_k(x)$ тоже равномерно сходится на $X$.

**Доказательство**
По критерию Коши: $\forall \epsilon > 0 \exists N = N(\epsilon): \forall x \in X\ \forall n > m > N:\ \sum\limits_{k = m+1}^n b_k(x) < \epsilon$.
Тогда имеем: $$\left| \sum\limits_{k = m + 1}^n\right| \leq \sum\limits_{k = m + 1}^n |a_k(x)| \leq \sum\limits_{k = m+1}^n b_k(x) < \epsilon$$
Таким образом, уловие Коши выполняется и для $\sum\limits_{k=1}^{+\infty} a_k(x)$. Теорема доказана.

### Теорема: признак Дирихле
**Теорема**
Если
- При каждом фиксированном $x_0 \in X$ числовая последовательность $a_k(x_0)$ монотонна
- Функциональная последовательность $a_k(x)$ равномерно сходится к $f \equiv 0$ на $X$
- Частичные суммы $\sum\limits_{k=1}^n b_k(x)$ ==равномерно ограничены== на $X$, то есть $$\exists M : \forall n \in \mathbb N\ \forall x \in X\ \left|\sum\limits_{k=1}^n b_k(x) \right| \leq M$$
Тогда ряд $\sum\limits_{k=1}^{+\infty} a_k(x) b_k(x)$ равномерно сходится на $X$.

**Доказательство**
Хотим получить оценку вида $\sum\limits_{k=m+1}^n a_k(x) b_k(x) < \epsilon$, чтобы сослаться на критерий Коши. Применяя те же рассуждения, что и в преобразовании Абеля получаем $$\sum\limits_{k = m+1} a_k(x) b_k(x) = a_n(x) V_n(x) - \sum\limits_{k = m+1} V_k(x)(a_{k+1}(x) - a_k(x))$$ Здесь $V_j(x) = \sum\limits_{k = m+1}^j b_k(x),\ V_m(x) := 0$. Всё аналогично обычнтому преобразованию Абеля, где сдвинут нижний индекс.

По условию равномерной ограниченности:
$$|V_j(x)| = \left|\sum\limits_{k = m+1}^j b_k(x)\right| = \left|\sum\limits_{k=1}^j b_k(x) - \sum\limits_{k=1}^m b_k(x) \right| \leq$$ $$\leq \left|\sum\limits_{k=1}^j b_k(x)\right|+\left|\sum\limits_{k=1}^{m} b_k(x)\right| \leq 2M$$
Получаем $$\left|\sum\limits_{k = m+1}^n a_k(x)b_k(x)\right| = \left|a_n(x)V_n(x) - \sum\limits_{k = m+1}^{n-1} V_k(x)(a_{k+1}(x) - a_k(x))\right| \leq$$ $$\leq |a_n(x) V_n(x)| + \left|\sum\limits_{k = m+1}^{n-1} V_k(x)(a_{k+1}(x) - a_k(x))\right| \leq$$ $$\leq 2M|a_n(x)| + 2M\sum\limits_{k = m+1}^{n - 1} |a_{k+1}(x) - a_k(x)|\quad (🦋)$$
По условию, $a_n(x) \rightrightarrows 0$, то есть при больших $n$ и $m$ для всех $x\in X$$$|a_n(x)| < \epsilon,$$$$|a_{m+1}(x)| < \epsilon\quad (🌷)$$
Дано, что $\forall x_0 \in X$ числовая последовательность $a_n(x_0)$ монотонна. Значит, $$\sum\limits_{k = m+1}^{n-1} |a_{k+1}(x) - a_k(x)| = \left|\sum\limits_{k = m+1}^{n-1}(a_{k+1}(x) - a_k(x))\right| =$$$$ =|a_n(x) - a_{m+1}(x)|\quad (🐌)$$
Подставляя $(🌷)$ и $(🐌)$ в $(🦋)$ и используя неравенство треугольника, получаем
$$(🦋) < 2M\epsilon + 2M|a_n(x) - a_{m+1}(x)| \leq 2M\epsilon + 2M(|a_n(x)| + |a_{m+1}(x)|)$$
Продолжаем оценку, снова применяя $(🌷)$:
$$(🦋) = \left|\sum\limits_{k=m+1}^n a_k(x) b_k(x)\right| < 2M\epsilon + 2M(|a_n(x)| + |a_{m+1}(x)|) <$$
$$< 2M\epsilon + 2M(\epsilon + \epsilon) = 6M\epsilon$$

### Теорема: признак Абеля
**Теорема**
Если
- Функциональная последовательность $a_n(x)$ равномерно ограничена на $X$, то есть $$\exists M : \forall n \in \mathbb N\ \forall x \in X\ |a_n(x)| \leq M$$
- При каждом фиксированном $x_0 \in X$ числовая последовательность $a_k(x_0)$ монотонна
- Ряд $\sum\limits_{k=1}^{+\infty}b_k(x)$ равномерно сходится на $X$
Тогда ряд $\sum\limits_{k=1}^{+\infty} a_k(x)b_k(x)$ равномерно сходится на $X$.

**Доказательство**
Используем версию преобразования Абеля из признака Дирихле. Используя неравенство треугольника и равномерную ограниченность $a_k(x)$, получаем:
$$\left|\sum\limits_{k = m+1}^n a_k(x) b_k(x)\right| \leq |a_n(x) V_n(x)| + \left|\sum\limits_{k = m+1}^{n-1} V_k(x)(a_{k+1}(x) - a_k(x))\right| \leq$$
$$\leq M|V_n(x)| + \sum\limits_{k = m+1}^{n-1} |V_k(x)||a_{k+1}(x) - a_k|\quad (🍙)$$

Вспомним, что $$V_k(x) = \sum\limits_{j = m+1}^k b_j(x)$$
Знаем, что ряд $\sum\limits_{k=1}^{+\infty} b_k(x)$ равномерно сходится на $X$, значит, для больших $m$, по критерию Коши,$$|V_k(x)| < \epsilon,\ k > m + 1$$
Подставим это в оценку:
$$(🍙) \leq M\epsilon + \epsilon\sum\limits_{k=m+1}^{n-1} |a_{k+1}(x) - a_k(x)|$$
Используя монотонность и равномерную ограниченность $a_k(x)$, получаем, что
$$\sum\limits_{k = m+1}^{n-1} |a_{k+1}(x) - a_k(x)| = \left|\sum\limits_{k = m+1}^{n-1} (a_{k+1}(x) - a_k(x))\right| =$$
$$= |a_n(x) - a_{m+1}(x)| \leq |a_n(x)| + |a_{m+1}(x)| \leq 2M$$
Но тогда
$$\left|\sum\limits_{k=m+1}^n a_k(x) b_k(x)\right| = (🍙) \leq M\epsilon + 2M\epsilon = 3M\epsilon$$

### Теорема: равномерная сходимость сохраняет непрерывность функции
**Теорема**
- $f_n(x)$ определены в некоторой окрестности $x_0$.
- $f_n(x)$ непрерывны в $x_0$
- $f_n(x)\rightrightarrows f$ в $O(x_0)$
Тогда $f$ непрерывна в $x_0$

**Доказательство**
Хотим показать, что $\lim\limits_{x\to x_0} f(x) = f(x_0)$.
$$|f(x) - f(x_0)| = |f(x) - f_n(x) \pm f_n(x) \pm f_n(x_0)| \leq$$ $$\leq |f(x) - f_n(x)| + |f_n(x_0) - f(x_0)| + |f_n(x) - f_n(x_0)| < 3\epsilon$$

**Следствие 1**
В условиях теоремы можно переставлять пределы местами, то есть $\lim\limits_{n\to\infty}\lim\limits_{x\to x_0} f_n(x) = \lim\limits_{x\to x_0} \lim\limits_{n\to \infty} f_n(x)$

**Доказательство следствия 1**
$$\lim\limits_{n\to\infty}\lim\limits_{x\to x_0} f_n(x) = \lim\limits_{n\to\infty} f_n(x_0) = f(x_0)$$
$$\lim\limits_{x\to x_0}\lim\limits_{n\to\infty} f_n(x) = \lim\limits_{x\to x_0} f(x) = f(x_0)$$

### Следствие 2: теорема о непрерывности функциональных рядов
$\sum\limits_{k = 1}^\infty a_k(x)$
- $\forall k: a_k(x)$ определена в $O(x_0)$
- $\forall k: a_k(x)$ непр. в $x_0$
- $\sum a_k \rightrightarrows S(x)$
Тогда $S(x)$ непрерывна и $\sum\limits_{k=1}^\infty a_k(x) = \sum\limits_{1}^\infty \lim\limits_{x\to x_0}^\infty a_k(x)$

**Доказательство следствия 2**
- S_n(x) = \sum\limits_1^n a_k(x)$
- $\forall n: \sum\limits_1^n a_k(x)$ определена в $O(x_0)$
- $\forall n: \sum\limits_1^n a_k(x)$ непрерывна в $x_0$
Применяем теорему.

### Пример
Последовательность всюду разрывных функций $f_n$ равномерно сходится к непрерывной $f$.
$f_n(x) = \begin{cases}\dfrac 1 n, x \in \mathbb Q \\ 0, x \notin \mathbb Q \end{cases}\rightrightarrows f\equiv 0$

$\zeta(x) = \sum\limits_1^\infty \dfrac{1}{n^x}$ - дзета-функция Римана

### Теорема о _кто_
**Теорема**
Предположим, что $f_n$ непрерывны на $[a,b]$ и последовательность $f_n \rightrightarrows f$ на $[a, b]$. Тогда $\int\limits_a^x f_n(t)\,dt \rightrightarrows \int\limits_a^x f(t)\,dt$

**Доказательство**
$\forall n: f_n$ непрерывна на $[a,b]$ \implies $f_n$ интегрируема
$$(?)\quad \sup\limits_{x\in[a,b]} \left|\int\limits_a^x f_n(t)\,dt - \int\limits_a^x f(t)\,dt\right| \to 0\quad (?)$$
$$\sup\limits_{x\in [a,b]}\left|\int\limits_a^x(f_n(t) - f(t))\,dt\right| \leq \sup\limits_{[a,b]}\int\limits_a^x\left|f_n(t) - f(t)\right|\,dt \leq$$
$$\leq \left\{\begin{align} f_n\rightrightarrows f,\ [a,b] \\ \forall t \in [a,b]\ |f_n(t) - f(t)| < \epsilon \end{align}\right\} \leq \epsilon(b - a)$$

Функция $f$ интегрируема, так как $f$ - непрерывна.


**Следствие 1**
В условиях теоремы верно, что $\lim\limits_{n\to\infty} \int\limits_a^b f(t)\,dt = \int\limits_a^b\lim\limits_{n\to\infty} f_n(t)\,dt$

**Следствие 2**
$\sum\limits_1^\infty a_k(x)$
- $a_k(x)$ непрерывна на $[a, b]$
- $\sum a_k(x) \rightrightarrows S(x)$ на $[a, b]$
Тогда $S(x)$ интегрируема на $[a, b]$ и $\int\limits_a^b{\sum\limits_1^\infty a_k(x)\,dx} = \sum\limits_1^\infty\int\limits_a^b a_k(x)\,dx$

### Пример, когда нельзя поменять бесконечную сумму и интеграл местами
$$f_n(x) = \begin{cases} 2n^3x,\ 0\leq x\leq \dfrac{1}{2n}\\ 2n^2 - 2n^3x,\ \dfrac{1}{2n} \leq x \leq \dfrac 1 n\\ 0,\ \dfrac 1 n \leq x \leq 1\end{cases} \to f\equiv 0$$
$$\lim\limits_{n\to\infty} \int\limits_0^1 f_n(x)\,dx = +\infty$$
$$\lim\limits_{n\to\infty} f_n(x)\,dx = 0$$

В этом случае отсутствует условие равномерной сходимости, нужное для теоремы.


### Теорема о диффференцировании функциональных последовательостей
**Теорема**
- $\exists x_0 \in [a,b]: f_n(x_0)$ cходится
- $f_n(x)$ - непрерывно дифференцируемы на $[a, b]$
- $f_n'(x) \rightrightarrows \varphi(x)$ на $[a, b]$
Тогда $f_n\rightrightarrows f$ на $[a, b]$ и $f'(x) = \varphi(x)$, то есть $(\lim\limits_{n\to\infty} f_n(x))' = \lim\limits_{n\to\infty} f_n'(x)$

**Доказательство**
$f_n$ и $f_n'$ - непрерывны, поэтому можно применить формулу Ньютона-Лейбница:
$$f_n(x) - f_n(x_0) = \int\limits_{x_0}^c f_n'(t)\,dt \rightrightarrows \int\limits_{x_0}^x \varphi(t)\,dt\quad (†)$$
Применим предыдущую теорему:
$$\int\limits_{x_0}^c f_n'(t)\,dt \rightrightarrows \int\limits_{x_0}^x \varphi(t)\,dt$$
$f_n(x_0)$ сходится $\implies$ $f_n(x_0) \rightrightarrows$ (так как от $x$ не зависит)
$$f_n(x) = \int\limits_{x_0}^x f_n' + f_n(x_0)$$
Сумма равномерно сходящихся равномерно сходится (по неравенству треугольника).

Таким образом, $f_n \rightrightarrows f$. Покажем, что $f'(x) = \varphi$.
В $(†)$ в левой части перейдём к $\lim\limits_{n\to\infty}$. $f(x) - f(x_0) = \int\limits_{x_0}^x \varphi(t)\,dt$, так как равномерный предел равен поточечному. Теперь можно дифференцировать:
$$f'(x) = \varphi (x)$$

## Степенные ряды

> [!abstract] Степенной ряд
> Ряд вида $\sum\limits_1^\infty a_k(x - x_0)^k,\ a_k\in\mathbb R$ - ==степенной ряд== с центром в точке $x_0$.


> [!warning] Ало
> Можно сделать замену $t = x - x_0$, поэтому б.о.о. будем рассматривать ряди $\sum a_kx^k$

### Теорема: первая теорема Абеля
**Теорема**
1) Пусть $\sum a_k\overline {X}^k$ сходится, $\overline X^k \neq 0$. Тогда $\sum\limits a_k x^k \rightrightarrows$ на любом $[-q, q]$, где $|q| < |\overline x|$, и он абсолютно сходится.
2) Пусть $\sum a_k \overline X^k$ расходится. Тогда $\forall x: |x| > |\overline x| \implies \sum a_k x^k$ сходится

**Доказательство**
1) $$|a_kX^k| = \dfrac{|a_k \overline X^k| \cdot |x^k|}{|\overline x^k|} \leq \left\{\begin{align} |a_k\overline x|\leq M \\\text{т.к.} \sum\limits a_k\overline x^k \text{ сходится}\end{align} \right\}$$$$ \leq M \left | \dfrac{x}{\overline x}\right| \leq M\left(\dfrac{q}{|\overline x|}\right)^ k - \text{сходится}$$
2) От противного. $\exists x : |x| > |\bar x|: \sum\limits a_k x^k\ \text{сх.}$ По п.1 $\sum\limits a_k \bar x$ сходится. Противоречие.

### Радиус сходимости

> [!abstract] Радиус сходимости степенного ряда
> $R:= \sup\left\{|x|: \sum\limits a_k x^k\text{ сходится}\right\} \in \mathbb R \cup \{+\infty\}$ - ==радиус сходимости степенного ряда==

### Теорема: следствие из 1-й теоремы Абеля
**Теорема**
1) $\sum\limits a_kx^k$ абсолютно сходится на $(-R,  R)$
2) $\sum\limits a_k x^k \rightrightarrows$ на $\forall [-q, q] \subset (- R,  R)$
3) $S(x)$ непрерывна на $(-R,R)$
4) $S$ интегрируема на $[a, b] \subset (-R, R)$

**Доказательство**
1) $R = \sup \dots$. 
2) _сидел прогал и потерял.._

### Теорема: вторая теорема Абеля
**Теорема**
Пусть $\sum\limits a_k x^k$ сходится в $R\ (- R)$. Тогда $\sum\limits a_k x^k \rightrightarrows$ на $[0,\mathbb R]\ ([-\mathbb R, 0])$.

**Доказательство**
Признак Абеля. Пусть б.о.о. сходится в $\mathbb R$. Тогда $a_k x^k = a_k\mathbb R \cdot \dfrac{x^k}{\mathbb R^k}$

### Лемма о верхнем пределе
**Лемма**
Пусть $\{u_k\}$ - произвольная последовательность b $\{v_k\}: \exists v:=\lim\limits_{k\to\infty} v_k\neq 0$. Тогда $\overline{\lim\limits_{k\to\infty}} w_k = \overline{\lim\limits_{k\to\infty}} u_kv_k = v\overline{\lim\limits_{k\to\infty}} u_k$.

**Доказательство**
$\exists k_e: u_{k_e} \to \overline{\lim\limits_{k\to\infty}} u_k$ - по свойству $\overline{\lim}$
Возьмём подпоследовательность с индексами $k_e$. Тогда $$w_{k_e} = u_{k_e}\cdot v_{k_e} \to v\overline{\lim\limits_{k\to \infty}}u_k \leq \overline{\lim\limits_{k\to\infty}}w_k$$
Возьмём $k_t$ такую, что $w_{k_t}\to\overline{\lim\limits_{k\to\infty}} u_k$. Тогда $w_{k_t}=u_{k_t}v_{k_t}$. Тогда $$u_{k_t} = \dfrac{w_{k_t}}{v_{k_t}}\to \dfrac{\overline{\lim} w_k}{v} \leq \overline{\lim} u_k$$
Домножим на $v$:
$$\overline{\lim}w_k \leq v\overline{\lim} u_k$$
Мы получили две оценки с разных сторон.

### Лемма: обобщённый признак Коши сходимости числового ряда
**Лемма**
$\sum\limits_1^\infty p_k,\ \bar p = \overline{\lim\limits{k\to\infty}}\sqrt[k]{|p_k|}$
Если
- $\bar p < 1\implies$ряд сходится
- $\bar p > 1 \implies$ ряд расходится

**Доказательство**
$\bar p < 1$. $\bar p = \overline{\lim\limits_{k\to\infty}} \sqrt[k]{|p_k|} \implies$ $\exists N: \forall k > N\ \sqrt[k]{|p_k|} < q$. От противного. Пусть $\forall N \exists k > N: \sqrt[k]{|p_k|} \geq q$
- если $\sqrt[k]{|p_k|}$ не ограничена $\implies$ можно выделить подпоследовательность с верхним пределом $=\infty$
- Если $\sqrt[k]{|p_k|} \geq q \implies$ по теореме Больцано-Вейершнтасса $\exists \sqrt[k_e]{|p_k|} \to b \geq q$, то есть расходится.

$\bar p = \overline{\lim} \implies p_{k_t} \to \bar p$. Тогда $\forall\epsilon > 0 \exists N(\epsilon): \forall k_t > N\quad |\bar p - p_{k_t}| < \epsilon$. Тогда $|p_k| < q^k$, и $q^k$ - геом.прогрессия. Поэтому $|p_k|$ сходится.

$\bar p > 1$. Возьмём $\bar \epsilon  = \bar p - 1$. Тогда $$\bar p - |p_{k_t}| \leq |\bar p - p_{k_t}| < \bar p - 1$$
Перенесём $|p_{k_t}|$ вправо
$$1 \leq |p_{k_t}|$$
Тогда ряд расходится по необходимому условию сходимости.

### Теорема Коши-Адамара
**Теорема**
$R = \dfrac{1}{\overline{\lim\limits_{k\to\infty}}\sqrt[k]{|a_{k}|}}$, $\sum\limits a_k x^k$

**Доказательство теоремы** 
- $|x| < R$. Покажем, что при таких $x$ ряд сходится. $p_k = a_kx^k$. Предположим, что $x\neq 0$, так как в нуле ряд всегда сходится. Тогда $$\overline{\lim\limits_{k\to\infty}} \sqrt[k]{|p_k|} = \overline{\lim\limits_{k\to\infty}}\sqrt[k]{|a_k||x^k|} = $$$$= \text{\{лемма о верхнем переделе\}} = |x|\cdot\overline{\lim}\sqrt[k]{|a_k|} < $$$$< \dfrac{1}{\overline{\lim}\sqrt[k]{|a_k|}} \cdot \overline{\lim}\sqrt[k]{|a_k|} = 1$$
  Тогда по признаку Коши ряд сходится.
  
- $|x| \geq \dfrac{1}{\overline{\lim}\sqrt[k]{|a_k|}}$. Делаем то же самое, получаем оценку $>1 \implies$ ряд расходится.
- $\dfrac{1}{\overline{\lim}\sqrt[k]{|a_k|}}$ - тогда $\overline{\lim}\sqrt[k]{a_k|x^k|} = |x|\cdot 0 < 1$ - ряд сходится.
- $\overline{\lim}\sqrt[k]{|a_k|} = +\infty \implies$ ряд расходится.

### Теорема: бесконечная дифференцируемость степенного ряда
**Теорема**
Рассмотрим $\sum\limits a_kx^k = S(x)$. Тогда $S'(x)$ - производная степенного ряда = $\sum\limits ka_kx^{k-1}$ и радиус сходимости $S'$ равен радиусу сходимости $S$.

**Доказательство**
Рассмотрим $\sum\limits ka_kx^{k-1}$. Тогда $$R' = \dfrac{1}{\overline{\lim\limits_{k\to\infty}}\sqrt[k]{k|a_k|}} = \left\{\sqrt[k]{k}\to 1\right\} = \text{\{лемма о верхнем пределе\}} =$$$$= \dfrac{1}{\overline{\lim}\sqrt[k]{|a_k|}}$$ Поэтому радиус сходимости совпадает с исходным. Покажем, что ряд из производных равен $S'$. Восмользуемся теоремой о дифференцируемости функционального ряда.
- $\exists x_0: \sum\limits a_k x_0^k$ сходится
- $a_kx^k$ непрерывно дифференцируем
- $\sum\limits ka_kx^{k-1} \rightrightarrows$ на $[-q, q]$ ?

Возьмём произвольный $[-q, q] \subset (-R, R)$. По 1й теореме Абеля $\sum\limits ka_kx^{k-1} \rightrightarrows$ на $[-q, q] \implies$ на $[-q, q]$ $S'(x) = \sum\limits ka_kx^{k-1}$. Так как $q$ произвольно, то это выполняется и на $(-R, R)$.

**Следствие**
По индукции $S$ - бесконечно дифференцируема. Поэтому $f(z), z\in \mathbb C$: $$\lim\limits_{\Delta z \to 0} \dfrac{f(z + \Delta z) - f(z)}{\Delta z} = f'(z), \text{ в } O(z)$$Если существует производная, то $f$ - ==аналитична==. Тогда у комплексных функций существует бесконечно много производных, если существует хотя бы одно. И таким образом, функция аналитична, только если она представима в виде степенного ряда (ряда Тейлора).

### Теорема: все степенные ряды являются рядами Тейлора
**Теорема**
$S(x) = \sum\limits a_kx^k$. Тогда $S(x) = \sum\limits\dfrac{S^{(k)}(0)}{k!}x^k$ - ряд тейлора

**Доказательство**
$$S^{(k)}(x) = \left(\sum\limits_{j<k}'\right)^{(k)} + (a_kx^k)^{(k)} + \left(\sum\limits_{j > k}\right)^{(k)} = a_kk! + (a_{k+1}x^{k+1} + \dots)$$

$$a_a = \dfrac{S^{(k)}(0)}{k!}$$
### Теорема Вейерштрасса о равномерном приближении функции многочленом
**Теорема**
Пусть $f$ непрерывна на $[a, b]$. Тогда $\forall\varepsilon > 0$ существует многочлен $P_\varepsilon(x)$, такой, что $\max\limits_{[a,b]}|f(x) - P_\varepsilon(x)| < \varepsilon$

**Доказательство**

> [!abstract] Многочлены Бернштейна
> $$B_{n,k}(x) = C_n^kx^k(1-x)^{n-k},\ 0\leq k\leq n$$
> -- ==многочлен Бернштейна==
> Свойства:
> 1. $\sum\limits_{k=1}^n = C_n^kx^k(1-x)^{n-k} = \sum\limits_{k=0}^n B_{n,k=1}$
> 2. Поведение на $[0,1]$. $B'_{n,k}(x) = C_n^k(kx^{k-1}(1-x)^{n-k} - x^k(n -k)(1-x)^{n-k-1}) = 0$ $\implies$ возрастает на $[0, \dfrac k n]$, убывает на $[\dfrac k n, 1]$
> 3. $\sum\limits_{k=0}^n \dfrac k n B_{n,k(x)} = x$
> 4. $\sum\limits_{k=0}^n\dfrac{k^2}{n^2} B_{n ,k(x)} = \dfrac{x}{n} + \dfrac{(n-1)}{n}\cdot x^2$
> 5. $\sum\limits_0^n(\dfrac k n - x)^2 B_{n, k(x)} = \dfrac{x - x^2}{n}$

1) Для отрезка $[0,1]$. Сопоставим $f$ многочлен $p(x) = \sum\limits_0^N f(\dfrac k n)B_{n,k}(x)$. $f(x) - p(x) = \text{\{св-во 1\}} =$ $= \sum\limits^n_0\left(f(x) - f\left(\dfrac k n\right)\right)B_{n,k}(x)$ = \text{\{рассмотрим два семейства индексов\}} =$= \sum\limits_{k\in I} + \sum\limits_{k\in II}$, где $$I=I(x) = \left\{k: \left|\dfrac k n - x\right| < \dfrac{1}{n^{\frac 1 4}}\right\}$$$$II = II(x) = \left\{k: \left|\dfrac k n - x\right|\geq \dfrac{1}{n^{\frac 1 4}}\right\}$$
   1. $$\left|\sum\limits_{k\in II}\right|\leq \sum\limits_{k\in II}\left|f(x) - f(\dfrac k n)\right|\cdot |B_{n,k(x)}| \leq \{f\leq M\text{ на }[a,b]\} \leq $$$$\leq 2M\cdot\sum\limits_{k\in II}B_{n,k}(x)\cdot\dfrac{\left(\dfrac k n - x\right)^2}{\left(\dfrac k n - x\right)^2} \leq 2M\sqrt{n}\sum\limits_{k\in II} B_{n,k}(x)(\dfrac k n - x)^2 \leq$$$$\leq 2M\sqrt{n} \sum\limits_{k=0}^n = 2M\sqrt{n}\left(\dfrac{x - x^2}{n}\right) \leq \dfrac{2M}{\sqrt{n}} < \dfrac \varepsilon 2$$
   2. По теореме Кантора $f$ равномерно непрерывна на $[0,1]$. Возьмём $\varepsilon' = \dfrac{\varepsilon}{2}$. Тогда $\exists\delta(\varepsilon'): \dfrac 1 {n^{\frac{1}{4}}} < \delta(\varepsilon')$ при больших $n$. Тогда $$\left|\sum\limits_{k\in I}\right| \leq \sum\limits_{I}\left|f(x) - f(\dfrac k n)\right|B_{n, k}(x) < \dfrac \varepsilon 2$$
2) $x = a+ (b - a)t$ на $[a, b]$. Пусть $f$ определена на $[a, b]$. Сделаем замену $f(x) = f(a + (b - a)t) = g(t)$, определённая на $[0, 1]$. $|g(t) - p(t)| < \varepsilon$






